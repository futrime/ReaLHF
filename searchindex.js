Search.setIndex({"alltitles": {"APIs": [[0, "apis"]], "Algorithm Representation": [[5, "algorithm-representation"]], "Base Modules": [[0, "base-modules"]], "Cluster Spec": [[3, "cluster-spec"]], "Code Architecture": [[0, "code-architecture"]], "Communication": [[0, "communication"]], "Configurations": [[4, "configurations"]], "Contributing": [[1, "contributing"]], "Core APIs": [[0, "core-apis"]], "Customization": [[2, "customization"]], "Customized Experiments": [[0, "customized-experiments"]], "Customizing Algorithms": [[2, "customizing-algorithms"]], "Customizing Datasets": [[2, "customizing-datasets"]], "Customizing Models": [[2, "customizing-models"]], "Data Packing": [[0, "data-packing"]], "Data Structure for Interfaces and Datasets": [[4, "data-structure-for-interfaces-and-datasets"]], "Data Transfer": [[5, "data-transfer"]], "Dataflow Graph": [[4, "dataflow-graph"]], "Dataset Configurations": [[4, "dataset-configurations"]], "Dataset and Model Implementations": [[0, "dataset-and-model-implementations"]], "Datasets": [[0, "datasets"]], "Distributed Experiments with Ray": [[3, "distributed-experiments-with-ray"]], "Distributed Experiments with SLURM + Pyxis": [[3, "distributed-experiments-with-slurm-pyxis"]], "Docker Images": [[7, "docker-images"]], "Documentation": [[1, "documentation"]], "Example: A Customized Reward Function for PPO": [[2, "example-a-customized-reward-function-for-ppo"]], "Examples": [[0, "id1"]], "Experiment Configurations": [[4, "experiment-configurations"]], "Formatting": [[1, "formatting"]], "Graceful Shutdown": [[3, "graceful-shutdown"]], "How Dataset Configuration is Parsed": [[2, "how-dataset-configuration-is-parsed"]], "HuggingFace Model Conversion": [[0, "huggingface-model-conversion"]], "Implementation Details": [[5, "implementation-details"]], "Install From PyPI or Source": [[7, "install-from-pypi-or-source"]], "Installation": [[7, "installation"], [9, "installation"]], "Introduction": [[8, "introduction"]], "Limitations of Existing Systems": [[8, "limitations-of-existing-systems"]], "MasW-ModW Communication": [[5, "masw-modw-communication"]], "Model Backends": [[0, "model-backends"]], "Model Configurations": [[4, "model-configurations"]], "Model Interfaces": [[0, "model-interfaces"]], "Model, Model Interface, and Model Backend": [[5, "model-model-interface-and-model-backend"]], "Models": [[0, "models"]], "Names and Name Resolving": [[0, "names-and-name-resolving"]], "Overview": [[0, "overview"], [2, "overview"], [2, "id1"], [2, "id2"], [5, "overview"]], "Parallelism Strategy": [[0, "parallelism-strategy"], [5, "parallelism-strategy"]], "Parameter Reallocation": [[5, "parameter-reallocation"]], "Performance Comparison": [[8, "performance-comparison"]], "Quickstart": [[9, "quickstart"]], "Quickstart APIs": [[0, "quickstart-apis"]], "RLHF with 4x LLaMA-7B in 30min": [[9, "rlhf-with-4x-llama-7b-in-30min"]], "Ray Resources": [[3, "ray-resources"]], "Runtime Infrastructure": [[5, "runtime-infrastructure"]], "Scripts for Running Existing Experiments": [[0, "scripts-for-running-existing-experiments"]], "Setting Up Distributed Experiments": [[3, "setting-up-distributed-experiments"]], "Stage 1: Supervised Fine-Tuning": [[9, "stage-1-supervised-fine-tuning"]], "Stage 2.1: Reward Modeling (RM)": [[9, "stage-2-1-reward-modeling-rm"]], "Stage 2.2: Direct Preference Optimization (DPO)": [[9, "stage-2-2-direct-preference-optimization-dpo"]], "Stage 3: PPO": [[9, "stage-3-ppo"]], "Standalone Scripts": [[0, "standalone-scripts"]], "Steps for Implementing a New Dataset": [[2, "steps-for-implementing-a-new-dataset"]], "Steps to Support a New HuggingFace Model": [[2, "steps-to-support-a-new-huggingface-model"]], "System-Level Configurations": [[4, "system-level-configurations"]], "Testing": [[1, "testing"]], "The Data Structure: realhf.SequenceSample": [[2, "the-data-structure-realhf-sequencesample"]], "The Next Step": [[9, "the-next-step"]], "The Procedure of Launching an Experiment": [[5, "the-procedure-of-launching-an-experiment"]], "Welcome to ReaL\u2019s documentation!": [[6, "welcome-to-real-s-documentation"]], "\u2b50 Contents \u2b50": [[6, "contents"]], "\ud83d\ude80 Get Started \ud83d\ude80": [[6, "get-started"]]}, "docnames": ["arch", "contributing", "customization", "distributed", "expconfig", "impl", "index", "install", "intro", "quickstart"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["arch.rst", "contributing.rst", "customization.rst", "distributed.rst", "expconfig.rst", "impl.rst", "index.rst", "install.rst", "intro.rst", "quickstart.rst"], "indexentries": {"bs (realhf.sequencesample property)": [[4, "realhf.SequenceSample.bs", false]], "commonexperimentconfig (class in realhf)": [[4, "realhf.CommonExperimentConfig", false]], "cuda() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.cuda", false]], "destroy() (realhf.modelbackend method)": [[4, "realhf.ModelBackend.destroy", false]], "disable_validation() (realhf.sequencesample class method)": [[4, "realhf.SequenceSample.disable_validation", false]], "dpoconfig (class in realhf)": [[4, "realhf.DPOConfig", false]], "eval_batch() (realhf.pipelinableengine method)": [[4, "realhf.PipelinableEngine.eval_batch", false]], "evaluate() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.evaluate", false]], "experimentsaveevalcontrol (class in realhf)": [[4, "realhf.ExperimentSaveEvalControl", false]], "forward() (realhf.pipelinableengine method)": [[4, "realhf.PipelinableEngine.forward", false]], "from_default() (realhf.sequencesample class method)": [[4, "realhf.SequenceSample.from_default", false]], "gather() (realhf.sequencesample class method)": [[4, "realhf.SequenceSample.gather", false]], "generate() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.generate", false]], "generate() (realhf.pipelinableengine method)": [[4, "realhf.PipelinableEngine.generate", false]], "generationconfig (class in realhf)": [[4, "realhf.GenerationConfig", false]], "generationhyperparameters (class in realhf)": [[4, "realhf.GenerationHyperparameters", false]], "get_split_spec() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.get_split_spec", false]], "inference() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.inference", false]], "initialize() (realhf.modelbackend method)": [[4, "realhf.ModelBackend.initialize", false]], "meta() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.meta", false]], "mfcconfig (class in realhf)": [[4, "realhf.MFCConfig", false]], "mfcdef (class in realhf)": [[4, "realhf.MFCDef", false]], "mock() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.mock", false]], "model (class in realhf)": [[4, "realhf.Model", false]], "modelbackend (class in realhf)": [[4, "realhf.ModelBackend", false]], "modelfamily (class in realhf)": [[4, "realhf.ModelFamily", false]], "modelinterface (class in realhf)": [[4, "realhf.ModelInterface", false]], "modelname (class in realhf)": [[4, "realhf.ModelName", false]], "modelshardid (class in realhf)": [[4, "realhf.ModelShardID", false]], "modeltrainevalconfig (class in realhf)": [[4, "realhf.ModelTrainEvalConfig", false]], "modelversion (class in realhf)": [[4, "realhf.ModelVersion", false]], "optimizerconfig (class in realhf)": [[4, "realhf.OptimizerConfig", false]], "pairedcomparisondatasetconfig (class in realhf)": [[4, "realhf.PairedComparisonDatasetConfig", false]], "parallelismconfig (class in realhf)": [[4, "realhf.ParallelismConfig", false]], "pipelinableengine (class in realhf)": [[4, "realhf.PipelinableEngine", false]], "ppoconfig (class in realhf)": [[4, "realhf.PPOConfig", false]], "ppohyperparameters (class in realhf)": [[4, "realhf.PPOHyperparameters", false]], "promptanswerdatasetconfig (class in realhf)": [[4, "realhf.PromptAnswerDatasetConfig", false]], "promptonlydatasetconfig (class in realhf)": [[4, "realhf.PromptOnlyDatasetConfig", false]], "realmodelconfig (class in realhf)": [[4, "realhf.ReaLModelConfig", false]], "remap_keys_() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.remap_keys_", false]], "rwconfig (class in realhf)": [[4, "realhf.RWConfig", false]], "save() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.save", false]], "sequencesample (class in realhf)": [[4, "realhf.SequenceSample", false]], "sftconfig (class in realhf)": [[4, "realhf.SFTConfig", false]], "split() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.split", false]], "split_with_spec() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.split_with_spec", false]], "train_batch() (realhf.pipelinableengine method)": [[4, "realhf.PipelinableEngine.train_batch", false]], "train_step() (realhf.modelinterface method)": [[4, "realhf.ModelInterface.train_step", false]], "unpack() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.unpack", false]], "update_() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.update_", false]]}, "objects": {"realhf": [[4, 0, 1, "", "CommonExperimentConfig"], [4, 0, 1, "", "DPOConfig"], [4, 0, 1, "", "ExperimentSaveEvalControl"], [4, 0, 1, "", "GenerationConfig"], [4, 0, 1, "", "GenerationHyperparameters"], [4, 0, 1, "", "MFCConfig"], [4, 0, 1, "", "MFCDef"], [4, 0, 1, "", "Model"], [4, 0, 1, "", "ModelBackend"], [4, 0, 1, "", "ModelFamily"], [4, 0, 1, "", "ModelInterface"], [4, 0, 1, "", "ModelName"], [4, 0, 1, "", "ModelShardID"], [4, 0, 1, "", "ModelTrainEvalConfig"], [4, 0, 1, "", "ModelVersion"], [4, 0, 1, "", "OptimizerConfig"], [4, 0, 1, "", "PPOConfig"], [4, 0, 1, "", "PPOHyperparameters"], [4, 0, 1, "", "PairedComparisonDatasetConfig"], [4, 0, 1, "", "ParallelismConfig"], [4, 0, 1, "", "PipelinableEngine"], [4, 0, 1, "", "PromptAnswerDatasetConfig"], [4, 0, 1, "", "PromptOnlyDatasetConfig"], [4, 0, 1, "", "RWConfig"], [4, 0, 1, "", "ReaLModelConfig"], [4, 0, 1, "", "SFTConfig"], [4, 0, 1, "", "SequenceSample"]], "realhf.ModelBackend": [[4, 1, 1, "", "destroy"], [4, 1, 1, "", "initialize"]], "realhf.ModelInterface": [[4, 1, 1, "", "evaluate"], [4, 1, 1, "", "generate"], [4, 1, 1, "", "inference"], [4, 1, 1, "", "mock"], [4, 1, 1, "", "save"], [4, 1, 1, "", "train_step"]], "realhf.PipelinableEngine": [[4, 1, 1, "", "eval_batch"], [4, 1, 1, "", "forward"], [4, 1, 1, "", "generate"], [4, 1, 1, "", "train_batch"]], "realhf.SequenceSample": [[4, 2, 1, "", "bs"], [4, 1, 1, "", "cuda"], [4, 1, 1, "", "disable_validation"], [4, 1, 1, "", "from_default"], [4, 1, 1, "", "gather"], [4, 1, 1, "", "get_split_spec"], [4, 1, 1, "", "meta"], [4, 1, 1, "", "remap_keys_"], [4, 1, 1, "", "split"], [4, 1, 1, "", "split_with_spec"], [4, 1, 1, "", "unpack"], [4, 1, 1, "", "update_"]]}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property"}, "terms": {"": [0, 2, 3, 4, 5, 7, 9], "0": [2, 3, 4, 5, 8, 9], "00": 9, "00001": 9, "00002": 9, "00003": 9, "00004": 9, "00005": 9, "00006": 9, "00007": 9, "00008": 9, "00009": 9, "00010": 9, "00011": 9, "00012": 9, "00013": 9, "00014": 9, "007": 9, "01": [3, 4], "02": [3, 4], "03": [4, 9], "04": 7, "05": 4, "051": 9, "07": 4, "081": 9, "083": 9, "094": 9, "1": [0, 2, 3, 4, 5, 6, 7], "10": [4, 5, 7, 9], "1000": [2, 4, 9], "10000": [3, 4], "1024": [4, 9], "10gb": 3, "11": 5, "12": 5, "128": 9, "13": [4, 5, 9], "13b": 8, "14": [5, 9], "141": 8, "15": [4, 5, 9], "152": 8, "17": [4, 8], "19": 9, "1d": [0, 2, 4], "1e": 4, "1x8": 5, "2": [0, 4, 5, 6, 7, 8], "20": 4, "200": 4, "20240618": 9, "216": 9, "22": 7, "23": 7, "256": [4, 9], "26": 9, "294": 9, "2d": 4, "2x8": 5, "3": [0, 4, 5, 6], "30min": 6, "312": 9, "32": 9, "34": 9, "34b": 8, "38": 9, "387": 9, "39": 9, "393": 9, "3d": [0, 2, 4, 5, 9], "3wd0": 4, "4": [4, 5, 7, 8, 9], "400": 8, "42": 4, "46": 9, "4x": 6, "5": [4, 5, 8, 9], "50": 9, "5000": 9, "512": 9, "52": 9, "53": 9, "54": 9, "56": 9, "574": 9, "6": [4, 5], "628": 9, "6379": 3, "7": [4, 5, 9], "70b": 8, "7780": 1, "7b": [4, 6, 8], "8": [4, 5, 7, 8, 9], "9": [2, 4, 5, 9], "906": 9, "95": 4, "99995": 4, "A": [3, 4, 5, 6, 7, 9], "As": [0, 3, 4, 9], "At": [2, 5], "By": [3, 8], "For": [0, 1, 2, 3, 4, 5, 6, 7, 9], "If": [0, 1, 2, 3, 4, 5, 6, 7, 9], "In": [0, 2, 3, 4, 5, 8, 9], "It": [0, 2, 3, 4, 5, 9], "Its": 4, "NOT": 4, "No": [3, 7], "On": [1, 3, 7], "One": 4, "Or": 7, "The": [0, 1, 3, 4, 6, 7, 8], "Then": 1, "There": [0, 2, 5], "These": [0, 2, 4, 5, 6, 9], "To": [0, 2, 3, 4, 7], "With": [4, 9], "_": [2, 4], "__getitem__": 2, "__handle_model_function_cal": 5, "__handle_one_rpc_hook": 5, "__init__": [0, 2], "__lazy_setup": 5, "__post_init__": 2, "_class": [4, 9], "_field_typ": 4, "_g": 4, "_get_model_worker_config": 5, "_missing_typ": 4, "_poll": 5, "_post_hook": 4, "_pre_hook": 4, "_resolve_seqlen_from_kei": 4, "a100": 3, "abl": [0, 2], "about": [0, 1, 3, 4, 9], "abov": [1, 2, 3, 4, 5, 9], "abs_position_embedding_offset": 4, "absolut": 4, "abstract": 5, "acceler": 4, "access": [3, 5], "accommod": 9, "accord": [3, 4, 7, 9], "accordingli": [0, 5], "accumul": 4, "accur": 4, "achiev": [0, 4, 5], "across": [4, 5, 9], "action": 4, "activ": [4, 5], "activation_funct": 4, "actor": [0, 2, 4, 5, 8, 9], "actor_gen": 4, "actor_train": [0, 4, 9], "actortrain": 9, "actual": [2, 4], "ad": 4, "adam": [4, 5], "adapt": 4, "add": [0, 3], "addit": [0, 2, 3, 4, 5, 9], "addition": [0, 4], "address": [0, 3, 8], "adjust": 7, "adopt": [0, 5, 9], "adv_norm": [4, 9], "advanc": [4, 6], "advantag": [0, 4], "after": [0, 1, 3, 4, 5, 7, 9], "again": 4, "aggreg": 4, "aggregate_fn": 4, "aigc": 9, "aka": 5, "algorithm": [0, 4, 6, 9], "align": 4, "aliv": 5, "all": [0, 1, 2, 3, 4, 5, 7, 9], "alloc": [0, 3, 4, 5, 9], "allocation_mod": [4, 9], "allocation_use_cach": 4, "allow": [0, 5, 7], "along": [0, 2, 4], "also": [0, 2, 4, 5, 7, 8, 9], "alter": 0, "altern": 8, "although": 4, "alwai": 5, "amend": 4, "among": [0, 9], "an": [0, 2, 3, 4, 6, 7, 8, 9], "analysi": 2, "ani": [0, 1, 2, 3, 4, 5, 9], "anneal": 4, "anoth": [3, 4, 5], "answer": [0, 4, 9], "api": [2, 4, 5, 6], "app": [0, 2, 3, 4, 5, 9], "appear": 0, "append": [3, 4, 5], "appli": [2, 4, 8], "applic": [1, 2, 9], "apply_rotari": 4, "approach": 4, "approxim": [0, 9], "ar": [0, 1, 2, 3, 4, 5, 6, 8, 9], "arbitrari": [3, 4], "architectur": [4, 6], "area": 8, "arg": [0, 2], "argument": [0, 2, 4], "arrai": 4, "art": 8, "assert": 4, "assign": [0, 8, 9], "assist": 1, "associ": [4, 5], "assum": [3, 4, 5, 9], "asymmetr": 8, "async_offload": 5, "asynchron": 5, "attempt": 0, "attent": [0, 4], "attention_mask": 2, "attn_pdrop": 4, "attribut": [4, 5, 9], "auto": 4, "automat": [1, 2, 3, 4, 5, 9], "automodelforcausallm": 9, "automodelforsequenceclassif": 2, "autotoken": 2, "avail": [0, 1, 3, 4, 5, 6, 7], "averag": [0, 4], "avoid": 9, "b": [2, 4], "back": [0, 2, 5], "backend": [2, 4, 6], "backward": [2, 4, 9], "balanc": [0, 4], "balanced_dp": 4, "bar": 8, "base": [4, 5, 6, 8], "baselin": 0, "bash": [0, 7, 9], "basic": [0, 2, 4, 6], "batch": [0, 2, 4, 5, 9], "batch_decod": 2, "beam": 0, "becaus": [0, 2, 4, 5, 8, 9], "becom": [3, 5], "been": [4, 5, 9], "befor": [0, 3, 4, 5], "behavior": [0, 2, 4, 5], "being": [5, 9], "below": [0, 2, 5], "benchmark": [4, 9], "benchmark_step": 4, "benefici": 9, "benefit": 4, "berlin": 9, "bert": 2, "besid": [5, 6, 9], "best": [0, 1, 9], "beta": 4, "beta1": 4, "beta2": 4, "between": [0, 2, 4, 5, 8, 9], "beyond": 0, "bf16": 4, "bia": 4, "bin": 9, "bind": 7, "black": 1, "block": [2, 4], "boilerpl": 4, "bool": 4, "both": [4, 5, 9], "bound": 5, "branch": 0, "break": 2, "brief": 6, "broadcast": [0, 5], "bt": 0, "buffer": [0, 4, 5], "bug": 4, "build": [5, 7], "build_graph": 5, "built": [0, 4, 7, 9], "c": [0, 1, 7], "cach": [3, 4], "cache_clear_freq": 4, "call": [0, 2, 3, 4, 5, 8, 9], "callabl": 4, "can": [0, 1, 2, 3, 4, 5, 7, 8, 9], "cannot": [0, 5], "capabl": 5, "capit": 9, "captur": 4, "case": [2, 4], "cat": [4, 9], "categor": 5, "caus": [5, 8, 9], "caution": 4, "cd": 7, "certain": 4, "cfg": 2, "challeng": 0, "chang": [0, 1, 2, 3, 4, 5, 9], "channel": [0, 5], "chat": [4, 8], "check": [2, 4, 5, 7, 9], "checkpoint": [0, 2, 3, 4, 9], "choos": 8, "clang": 1, "class": [0, 2, 4, 5], "classmethod": 4, "clear": 4, "cli": [3, 4], "clip": 4, "clone": [7, 9], "cluster": [0, 4, 5, 6, 7, 9], "cluster_config": 3, "cluster_nam": 3, "cluster_spec_path": 3, "cluster_typ": 3, "code": [1, 2, 4, 5, 6, 7], "codebas": 0, "codellama": 8, "coeffici": 4, "collect": [4, 5], "com": [3, 7], "com08": 4, "combin": 4, "come": 4, "comm": 0, "comma": 3, "command": [0, 1, 2, 3, 4, 7, 9], "comment": 9, "common": [4, 5, 9], "commonexperimentconfig": [4, 6], "commonli": [0, 2], "commun": [1, 6, 8, 9], "compar": [0, 4], "comparison": [0, 4, 6, 9], "compat": [0, 4], "compil": [2, 7], "complet": [0, 4, 5, 8, 9], "complex": [0, 9], "compon": 0, "compos": [0, 1, 8, 9], "comput": [0, 2, 4, 5, 8, 9], "concaten": [0, 2, 4], "concept": 0, "conceptu": [2, 5], "concret": [4, 5], "concurr": [5, 8], "condit": 4, "config": [0, 2, 4, 5, 9], "config_api": 2, "config_from_llama": 0, "config_to_llama": 0, "configur": [0, 3, 5, 6, 9], "connect": [3, 4], "consecut": 5, "consequ": [4, 9], "consid": 2, "consist": [2, 4, 5], "consol": 9, "constant": [0, 4, 5], "construct": [2, 4, 5], "constructor": 2, "consum": [3, 5, 7, 9], "consumpt": 9, "contact": 1, "contain": [0, 2, 4, 5, 7], "content": 0, "context": [4, 5, 9], "contigu": [2, 4], "continu": 5, "contribut": 6, "control": [3, 4, 5, 7, 9], "conveni": [0, 5, 9], "converg": 9, "convers": [2, 5, 6], "convert": [0, 2, 4], "copi": [0, 5], "core": [2, 3, 4, 5, 6], "correct": [0, 5], "correctli": [0, 3], "correspond": [0, 2, 4, 5, 9], "correspondingli": 5, "cosin": 4, "cost": 4, "could": 5, "counter": 4, "cover": [5, 6, 9], "cpu": [0, 1, 3, 4, 5, 7], "cpu_imag": 3, "creat": [0, 2, 3, 4, 5], "critic": [0, 2, 4, 5, 8, 9], "critic_inf": 4, "critic_train": 4, "crucial": 0, "csrc": 0, "ctl": 9, "cuda": [0, 2, 4, 7], "cuda_visible_devic": 0, "cumul": 4, "current": [0, 1, 3, 4], "custom": [4, 5, 6, 9], "custom_all_reduc": 0, "customized_exp": 5, "d": [4, 5], "d_i": 5, "data": [6, 9], "data_api": [0, 2, 4], "data_parallel_s": [4, 9], "data_transf": 0, "dataclass": [2, 4, 9], "dataflow": [0, 2, 5, 6], "dataload": [2, 4, 5], "datapack": 0, "dataset": [5, 6, 9], "dataset_path": 2, "datasetabstract": 2, "ddp": 0, "debug": 4, "decai": 4, "decod": [2, 4], "decompos": 5, "decoupl": [2, 4], "decreas": 4, "deeper": 6, "deepspe": [0, 4, 5, 8, 9], "deepspeedchat": 8, "def": 2, "default": [0, 3, 4, 9], "default_factori": 4, "default_mount": 3, "defin": [0, 4, 5, 6], "definit": [0, 5], "degre": [4, 8], "demonstr": 2, "denomin": 4, "denorm": 4, "denot": 5, "dens": 2, "dep": 7, "depend": [0, 2, 4, 5, 7, 8], "deploi": 9, "deploy": 7, "describ": 2, "descript": 0, "design": [2, 4, 9], "destin": [5, 7, 9], "destroi": 4, "detail": [0, 2, 4, 6, 9], "detect": [0, 3, 5], "determin": [0, 4, 5], "detoken": 0, "dev": 4, "develop": [0, 4, 6, 7, 9], "devic": [0, 3, 4, 5], "device_mesh": [0, 4], "dfg": [0, 4, 5], "dict": [2, 4], "dictionari": [2, 3, 4, 5, 9], "didn": 5, "differ": [0, 2, 4, 5, 8, 9], "difficult": 5, "digraph": [4, 5], "dimens": [0, 2, 4, 5], "dimension": 5, "direct": [4, 6], "directli": [0, 1, 4, 7, 9], "directori": [0, 3, 4, 7, 9], "disabl": 4, "disable_valid": 4, "discount": 4, "disjoint": 5, "dist": 5, "distinct": [4, 9], "distinguish": 9, "distribut": [0, 1, 4, 6, 8, 9], "diverg": 4, "divers": 4, "divid": 5, "do": [1, 2, 3, 4, 6], "do_layernorm_befor": 4, "doc": [1, 5], "docformatt": 1, "docker": [1, 3, 4, 6], "dockerfil": 7, "document": [0, 3], "doe": [0, 2, 3, 4, 5, 9], "doesn": 5, "don": [2, 4, 7], "done": 9, "down": [3, 4, 5], "download": 9, "dp": [4, 5], "dp_rank": 4, "dp_size": 4, "dpo": [0, 4, 5, 6], "dpoconfig": [4, 6], "driver": 3, "drop": 5, "dropout": 4, "dschat": 4, "dst": 7, "dtype": [2, 4], "due": [0, 2, 5, 9], "dump": 9, "dure": [0, 2, 4, 5], "dynam": [4, 5, 8], "e": [0, 2, 3, 4, 5, 6, 7, 8, 9], "each": [0, 2, 4, 5, 8, 9], "earli": 4, "earlier": 0, "early_stop_imp_ratio": 4, "easi": [0, 4], "easier": 5, "easiest": 7, "easili": [2, 4], "edg": [2, 4, 5], "edit": 7, "effect": [4, 5, 8], "effici": [0, 2, 4, 8, 9], "either": [3, 4, 5], "elast": 3, "element": 2, "elimin": 8, "embd_pdrop": 4, "embed": [2, 4], "emploi": 0, "empow": 1, "empti": [4, 5], "enabl": [0, 1, 4, 5, 8], "enable_bf16": 4, "enable_fp16": 4, "encod": 2, "end": [0, 2, 3], "enforc": 5, "engin": [0, 4, 9], "enough": 3, "enroot": 4, "ensur": [0, 2, 3, 4, 5], "entir": [4, 5, 8], "entri": [0, 4, 9], "entrypoint": [0, 5], "environ": [0, 3, 7], "ep": 4, "epoch": [4, 5, 9], "epoch7epochstep5globalstep50": 9, "epoch_step": 4, "eps_clip": 4, "epsilon": 4, "equal": [0, 2, 4], "equip": 5, "error": [0, 4, 5], "essenti": [4, 5], "estim": [4, 8], "etc": [0, 3, 4, 5], "eval": 2, "eval_batch": 4, "eval_dataload": [2, 4], "eval_freq_epoch": [4, 9], "eval_freq_sec": 4, "eval_freq_step": 4, "evalu": [0, 2, 4, 5], "even": [4, 5], "everi": [1, 2, 3, 4, 8], "exactli": [4, 9], "exampl": [3, 4, 5, 6, 9], "exce": 4, "except": [2, 9], "exclud": 4, "exclus": [4, 5], "execut": [0, 2, 4, 5, 8, 9], "exemplifi": 0, "exhibit": [2, 4], "exist": [2, 6, 7], "exit": 5, "exp": 4, "exp_ctrl": [4, 9], "expect": 0, "expens": 4, "experi": [2, 6, 7, 9], "experiment_nam": [2, 4, 9], "experimentconfig": [2, 5], "experimentsaveevalcontrol": [4, 6], "expert": 2, "explan": [0, 9], "exponenti": [0, 4], "export": 7, "expos": 0, "express": 3, "extens": [0, 7], "extent": 7, "extern": 2, "facilit": [2, 4, 5], "factor": 4, "factori": 4, "fail": 4, "failur": 4, "fals": 4, "famili": [0, 4], "familiar": [0, 4, 9], "fast": 9, "faster": [4, 9], "favor": 9, "feasibl": 9, "fed": 4, "fetch": 5, "few": 3, "field": [0, 2, 4, 5, 9], "figur": [2, 5, 8, 9], "file": [0, 1, 2, 3, 4, 5, 9], "fileroot": 3, "filesystem": 0, "fill": [4, 5], "filter": 4, "final": 2, "find": [0, 2, 4, 5, 9], "fine": [4, 6], "finetunespec": 4, "finish": [0, 9], "first": [2, 4, 5, 7, 8, 9], "flash": [0, 4], "flash_attn": 7, "flash_attn_varlen_func": 2, "flatten": 0, "flexibl": [0, 3, 5], "float": [2, 4], "float16": 4, "folder": [0, 1, 2, 5], "follow": [0, 2, 3, 4, 5, 7, 8, 9], "force_cudagraph_recaptur": 4, "force_no_logits_mask": 4, "forget": 2, "form": 9, "format": [4, 6, 9], "former": [0, 9], "forth": [0, 2], "forward": [2, 4, 5, 9], "found": [0, 2, 4, 5, 9], "four": [4, 9], "fp16": 4, "fragment": 0, "framework": 9, "franc": 9, "free": 4, "frequenc": [4, 9], "from": [0, 2, 4, 5, 6, 8, 9], "from_default": [2, 4], "from_hf": [0, 2, 4], "from_llama": [0, 2], "from_pretrain": [2, 9], "frozen": 9, "ft_spec": 4, "full": 8, "fulli": [0, 2, 4, 5, 9], "funcion": 2, "function": [0, 4, 5, 6, 9], "functor": 5, "furthermor": 5, "futur": 4, "fw": 9, "g": [0, 2, 3, 4, 5, 6, 7, 8, 9], "g0": 5, "g1": [3, 5], "g10": 5, "g11": 5, "g12": 5, "g13": 5, "g14": 5, "g15": 5, "g2": [3, 5], "g3": 5, "g4": 5, "g5": 5, "g6": 5, "g7": 5, "g8": [3, 5], "g9": 5, "gae": [0, 4, 5], "gae_lambda": 4, "garrett4wad": 7, "gather": [2, 4], "gconfig": 4, "gelu": 4, "gemma": 4, "gen": [0, 4, 9], "gen_interfac": 0, "gen_param": 4, "gener": [0, 2, 4, 5, 8, 9], "generationconfig": [4, 6], "generationhyperparamet": [4, 6], "get": [2, 3, 4, 5], "get_split_spec": 4, "git": 7, "github": [1, 7, 9], "given": [0, 4, 5, 9], "global": [0, 4, 5, 9], "global_comm": 0, "global_step": 4, "gpt": 4, "gpt2": 4, "gpu": [0, 1, 2, 3, 4, 5, 7, 8, 9], "gpu_imag": 3, "gpu_type_from_node_nam": 3, "gpu_util": 0, "grace": 6, "gradient": 4, "gradient_checkpoint": [4, 9], "gradual": 0, "grai": 8, "graph": [0, 2, 5, 6], "greater": 0, "greatli": 4, "greedi": [0, 4], "grid": 5, "group": [0, 5], "grouped_gemm": 7, "grpo": 0, "grpo_exp": 0, "guid": 0, "ha": [0, 2, 3, 4, 5, 9], "half": [5, 9], "handl": [2, 5, 9], "handler": [4, 5], "hard": 0, "hash": 4, "hashabl": [0, 2, 4], "have": [0, 1, 2, 3, 4, 5, 6, 9], "head": [3, 4, 9], "head_dim": 4, "heavi": 5, "help": [0, 1, 4, 9], "helper": [2, 4], "here": [0, 4, 7, 9], "hesit": 1, "heterogen": 5, "heurist": [0, 4, 9], "hf": [0, 4], "hf_registri": 2, "hidden": 4, "hidden_dim": 4, "highest": 4, "highlight": 4, "hold": [0, 5], "home": 3, "homogen": 3, "hook": [0, 5], "hope": 1, "host": [3, 5], "hostfil": 4, "hour": [8, 9], "how": [0, 5, 6, 9], "howev": [0, 3, 4, 5, 8], "http": [1, 7], "hub": 2, "huggingfac": [4, 5, 6, 9], "hydra": [0, 4, 5, 9], "hyperparamet": [4, 5, 9], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9], "id": [0, 2, 4, 5], "idea": 8, "ident": [0, 4, 5], "identifi": [2, 4], "idx": 2, "ignor": 4, "ignore_worker_error": 4, "illustr": [2, 4, 5, 6, 9], "imag": [3, 4, 5, 6], "image_nam": 4, "imdb": 2, "imit": 2, "impact": 4, "impl": [0, 2, 4, 5], "implement": [4, 6], "impli": 4, "implicitli": 9, "import": [0, 3, 4], "importantli": 2, "impract": 4, "improv": [1, 4, 8, 9], "includ": [0, 2, 3, 4, 5, 6, 9], "increas": [0, 3, 4, 8], "independ": [0, 4, 5, 9], "index": [0, 4, 5, 9], "indic": [2, 4, 9], "individu": [4, 5, 9], "ineffici": 4, "inf_reward_rpc": 2, "infer": [0, 2, 4, 5, 9], "info": 9, "inform": [3, 5], "infrastructur": [0, 6], "infref": 4, "infreward": 4, "infvalu": 4, "inherit": 5, "init": [3, 4], "init_critic_from_actor": [4, 9], "init_process_group": 5, "initi": [0, 2, 4, 5, 9], "initial_setup": [2, 5], "inject": [0, 2, 4], "inner": [2, 4], "innermost": 5, "inplac": 4, "input": [0, 2, 4, 5], "input_": [2, 4], "input_id": 2, "input_kei": 4, "input_key_remap": 4, "input_len": 2, "insert": 4, "insid": [5, 7], "instal": [1, 3, 6], "instanc": 5, "instanti": 0, "instead": [0, 4, 9], "instrctgpt": 9, "instruct": [0, 3, 7, 9], "insuffici": 5, "int": [2, 4], "int32": 2, "integ": [0, 3, 4], "integr": 0, "intend": 4, "interest": 4, "interfac": [2, 6], "interface_impl": [2, 4], "interface_typ": [2, 4], "interleav": 4, "intermedi": [4, 5], "intermediate_dim": 4, "intern": [0, 4, 5], "interv": 4, "intrins": 5, "introduc": [4, 5], "introduct": [6, 9], "inttensor": 2, "invers": 4, "invok": 0, "involv": [0, 2, 4, 5, 9], "io": 7, "ip": 3, "is_crit": [4, 9], "is_rew_lora": 4, "is_rw_lora": 4, "is_sft_lora": 4, "isol": [0, 7], "isort": 1, "issu": [0, 1, 2, 3], "iter": [2, 4, 5, 8, 9], "its": [0, 2, 3, 4, 5, 6], "itself": 0, "job": [3, 7], "json": [0, 3, 4, 9], "jsonl": [0, 4, 9], "just": [0, 4, 5], "k": [2, 4], "keep": [4, 5], "kei": [0, 2, 4, 5, 8, 9], "kept": [0, 5], "kernel": [0, 4], "kill": 3, "kl": [4, 9], "kl_ctl": [2, 4, 9], "know": 3, "known": [4, 5], "kv": 4, "kvcach": 4, "kw_onli": 4, "l": 9, "lambda": 4, "larg": [2, 9], "larger": [0, 4, 7], "largest": [4, 8], "last": [4, 5], "latest": 7, "latter": [0, 9], "launch": [0, 2, 3, 4, 6, 7, 9], "launcher": 5, "layer": [2, 4, 5, 9], "layer_norm_epsilon": 4, "layer_norm_typ": 4, "lead": [4, 7, 8], "learn": [0, 4, 5, 6, 9], "least": 4, "leav": 3, "legaci": 0, "length": [0, 2, 4, 5], "less": 4, "let": [2, 9], "level": [0, 5, 6], "librari": 0, "lifetim": 5, "light": 8, "lightweight": 5, "like": [0, 2, 3, 4, 5, 9], "limit": [0, 5, 6], "line": [0, 2, 4, 9], "linear": [4, 9], "list": [0, 2, 3, 4, 5, 9], "listen": 5, "llama": [0, 2, 4, 6, 8], "llm": [1, 4, 5, 9], "lm": [0, 4, 5], "load": [0, 2, 5, 9], "load_and_eval_rw": [0, 9], "load_data_func": 5, "loadabl": 9, "local": [0, 3, 4, 5, 6, 7, 9], "localhost": 1, "locat": [0, 2, 4, 5, 9], "log": [0, 3, 4, 9], "log_return_valu": 4, "logit": [2, 4], "logprob": 4, "long": 2, "longer": [0, 4, 5], "look": [4, 5], "lookup": 4, "loop": [4, 5], "lora": 4, "loraconfig": 4, "loss": [0, 4, 9], "loss_fn": 4, "low": [3, 4], "lower": 0, "lr": 4, "lr1e": 4, "lr_scheduler_typ": 4, "lustr": 9, "m": [0, 1, 2, 3, 4, 5, 9], "ma": 4, "machin": [3, 7], "made": 5, "mai": [0, 4, 5, 9], "main": [0, 4, 5, 9], "main_start": 0, "maintain": [4, 5], "major": [8, 9], "make": [0, 1, 4, 9], "make_dataset": 0, "manag": [3, 4, 5, 9], "mandatori": 6, "mani": [4, 5], "manual": [0, 3, 4, 5, 6, 9], "map": [2, 3, 4, 5], "mappingproxi": 4, "mark": [0, 4], "mask": 4, "master": [0, 2, 3, 4, 9], "master_work": 9, "masterwork": [2, 5], "masw": 6, "match": 3, "max_job": 7, "max_length": 2, "max_new_token": [4, 9], "max_pairs_per_prompt": [4, 9], "max_prompt_len": [4, 9], "max_reward_clip": 4, "max_seqlen": [2, 4, 9], "maxim": [5, 8, 9], "maximum": [0, 4, 5], "mean": [0, 3], "mechan": [0, 4], "meet": 4, "megatron": [0, 4, 5], "mem": 3, "member": 4, "memori": [0, 2, 3, 4, 5, 7, 9], "mention": 3, "merg": 1, "mesh": [0, 4, 5], "messag": [3, 5], "met": 4, "meta": 4, "metadata": [2, 4, 5], "method": [0, 2, 4, 5], "metric": 9, "mfc": [0, 2, 4, 5], "mfc1": 5, "mfc2": 5, "mfcconfig": [4, 6], "mfcdef": [0, 2, 4, 5, 6], "micro": [2, 4], "might": [0, 4], "min_lr_ratio": 4, "min_new_token": [4, 9], "min_siz": 4, "mini": [0, 4], "minibatch": 4, "minim": 0, "minimum": 4, "minor": 4, "minut": 9, "mixtur": 2, "mlp": 4, "mlp_type": 4, "mock": [2, 4], "mode": [0, 3, 4, 9], "model": [3, 6, 8], "model_api": [0, 2, 4], "model_nam": [2, 4], "model_parallel_s": [4, 9], "model_path": 4, "model_poll_step": 5, "model_rpc": 2, "model_scop": 5, "model_typ": 4, "model_work": [0, 2, 5, 9], "modelbackend": [0, 2, 4, 5, 6], "modelfamili": [0, 4, 6], "modelinterfac": [0, 2, 4, 5, 6], "modelinterfaceabstract": [2, 4], "modelinterfacetyp": 4, "modelnam": [0, 4, 6], "modelshardid": [0, 4, 6], "modeltrainevalconfig": [4, 6], "modelvers": [4, 6], "modelwork": [2, 5], "modifi": [0, 2, 4, 5, 7, 9], "modul": [4, 5, 6], "modw": 6, "moe": [2, 4, 7], "monitor": [0, 2], "more": [0, 2, 3, 4, 5, 7, 9], "moreov": 9, "most": [0, 4, 9], "mount": [3, 7], "move": [0, 4, 9], "movi": 9, "mp": 4, "mp_rank": 4, "mpi": 4, "multipl": [0, 1, 2, 4, 5, 6, 9], "multipli": 4, "must": [0, 4, 5, 7], "mutual": 4, "mw": 2, "my": [2, 3], "my_trial": 4, "myppoconfig": 2, "n": 5, "n_gpus_per_nod": [3, 4, 9], "n_kv_head": 4, "n_layer": 4, "n_mb": [2, 4], "n_node": [3, 4, 9], "n_posit": 4, "n_q_head": 4, "n_seq": 4, "name": [2, 3, 4, 5, 6, 9], "name_resolv": 0, "narrow": 4, "nativ": 4, "nccl": [0, 5], "nearli": 0, "necessari": [2, 3], "need": [2, 3, 4, 5], "neg": [0, 2, 9], "neg_answ": [0, 4, 9], "network": [0, 4, 5], "networkx": [4, 5], "neural": [0, 4, 5], "new": [0, 3, 4, 5, 6], "newli": [4, 9], "next": [3, 5, 6, 7], "nf": 3, "nn": [0, 2, 4], "no_grad": 2, "node": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "node01": [3, 4], "node02": [3, 4], "node03": 4, "node07": 4, "node_name_prefix": 3, "node_type_from_node_nam": 3, "nodelist": 4, "non": [0, 4, 5], "none": [2, 4, 9], "normal": [0, 4], "normalize_emb": 4, "note": [2, 3, 4, 5, 9], "noth": 4, "now": [2, 3, 9], "np": 0, "null": [0, 2, 9], "num": 3, "num_micro_batch": 4, "number": [0, 2, 4, 5, 7, 8, 9], "numpi": 4, "nvcr": 7, "nvida": 7, "nvidia": 7, "nx": 4, "object": [0, 2, 4, 5, 6, 9], "observ": [0, 8], "obtain": [0, 4], "occupi": [4, 5], "occur": [0, 4, 5], "off": 0, "offer": [0, 4, 7], "offload": [2, 4, 5, 9], "offloadhook": 4, "offset": 4, "often": [5, 8], "omit": [0, 4], "onc": [0, 2, 5, 9], "one": [2, 3, 4, 5], "ones": 2, "onli": [0, 2, 3, 4, 5, 7], "onlin": 2, "oom": [0, 4, 7], "open": [1, 8], "openpsi": 7, "openrlhf": 8, "oper": [0, 2, 4, 5], "oppos": 4, "opt": 4, "optim": [0, 4, 5, 6], "optimizerconfig": [4, 6], "option": [0, 2, 3, 4, 9], "ordinari": 9, "origin": [0, 2], "other": [0, 2, 4, 5], "otherwis": [3, 4, 5], "our": [1, 2, 3, 8, 9], "out": [0, 4, 9], "outer": [2, 4, 5], "outermost": 5, "output": [0, 2, 4, 5, 9], "output_fil": 4, "output_kei": 4, "output_key_remap": 4, "outsid": [5, 7], "over": [4, 8, 9], "overhead": [4, 5, 8, 9], "overlap": 5, "overrid": 4, "overview": 6, "overwritten": 9, "own": [0, 5], "owner": 5, "p": 4, "pack": [2, 4, 6], "packag": [0, 3, 7], "packed_input_id": [2, 4], "pad": [0, 2, 4], "pad_to_max_length": 4, "page": [1, 4], "pair": [0, 4], "pairedcomparisondatasetconfig": [2, 4, 6], "pairwis": [4, 9], "paper": [0, 9], "par": 0, "parallel": [2, 3, 4, 6, 7, 8, 9], "parallelismconfig": [4, 6], "param_realloc": 0, "paramet": [0, 2, 4, 6, 8, 9], "paramreallochook": 4, "pars": 6, "part": 4, "particular": 5, "partit": [0, 4], "pass": [2, 4, 5, 9], "path": [0, 2, 3, 4, 7, 9], "pattern": [2, 4, 5], "paus": 5, "peer": 5, "penalti": 4, "per": [0, 4, 5], "perform": [0, 2, 4, 5, 6, 9], "perspect": 5, "pickl": 4, "piec": [0, 2, 4, 5], "pip": 7, "pipe": [4, 9], "pipe_data": 4, "pipe_model": 4, "pipe_runn": 0, "pipelin": [0, 2, 4, 5, 8, 9], "pipelinableengin": [0, 2, 4, 5, 6], "pipeline_parallel_s": [4, 9], "pipemodeldataparalleltopologi": [0, 4], "pkl": 9, "placehold": [4, 5], "plan": [4, 9], "pleas": [0, 1, 2, 4, 5, 6, 7, 9], "plugin": [3, 4], "point": [0, 2, 4], "polici": 0, "port": 3, "portion": 5, "pos_answ": [0, 4, 9], "posit": [0, 2, 4, 9], "post": 5, "post_hook": [2, 4], "potenti": [4, 6, 7], "pp": [4, 5], "pp_rank": 4, "pp_size": 4, "ppo": [0, 3, 4, 5, 6], "ppo_exp": 4, "ppo_manu": 0, "ppo_n_minibatch": [4, 9], "ppo_prompt": 9, "ppo_ref_ema": 0, "ppo_senti": [0, 2, 5], "ppoconfig": [2, 4, 6], "ppohyperparamet": [4, 6, 9], "pr": [0, 1], "practic": [4, 9], "pre": [0, 5, 7, 9], "preced": 5, "precis": 4, "predict": 4, "prefer": [4, 6, 7], "prefetch_from_dataset": 5, "prefix": 3, "prepar": 9, "present": [4, 6], "pretrainedtokenizerfast": 4, "previou": [5, 8], "primari": [0, 4, 9], "primarili": 2, "prior": 8, "probabl": [4, 9], "problem": [4, 5], "proce": 9, "procedur": [6, 9], "proceed": [0, 6], "process": [0, 3, 4, 5, 8, 9], "processtopologi": [0, 5], "produc": [0, 2, 4, 5], "profil": [4, 8], "program": 4, "project": [4, 5, 7, 9], "promot": 4, "prompt": [0, 2, 3, 4, 9], "prompt_answ": 2, "prompt_answer_dataset": [0, 2], "prompt_dataset": 0, "prompt_len": 2, "promptanswerdataset": 2, "promptanswerdatasetconfig": [2, 4, 6], "promptonlydatasetconfig": [2, 4, 6], "properli": [0, 9], "properti": [2, 4, 5], "proport": 4, "propos": 0, "protocol": 5, "provid": [0, 2, 3, 4, 5, 7, 9], "pt": 2, "pull": [1, 7], "pure": 0, "purpl": 8, "purpos": 4, "push": 5, "py": [0, 1, 2, 4, 5, 9], "py3": 7, "pydant": 4, "pypi": [3, 6], "pytest": [0, 1], "python": [4, 9], "python3": [0, 2, 3, 4, 9], "pytorch": [0, 2, 5, 7], "pytorch_model": 9, "pyxi": [4, 6], "q": 1, "qkv": 4, "quarter": 5, "queri": 4, "question": 1, "queue": 5, "quickstart": [2, 3, 4, 5, 6, 7], "qwen2": 4, "r": 7, "rai": [0, 4, 5, 6], "rais": [0, 1, 4], "random": 4, "randomli": 4, "rang": [2, 4], "rank": [0, 4, 5], "rank_map": 5, "rate": [0, 4, 5, 9], "rather": 4, "ratio": 4, "raw": 4, "re": [2, 5, 9], "read": [0, 4, 6], "readi": 5, "real": [0, 2, 3, 4, 5, 7, 8, 9], "real_cuda": 7, "real_llm_api": 2, "real_model_api": 0, "real_no_ext": 7, "real_vers": 7, "realhf": [0, 3, 4, 5, 6, 7, 9], "realloc": [0, 2, 4, 6, 8], "realmodel": [0, 2, 4, 5], "realmodelconfig": [2, 4, 6], "realmoeconfig": 4, "reason": 2, "recal": 5, "receiv": [4, 5], "recogn": 4, "recommend": [3, 6, 7], "record": 2, "recov": 4, "recover_mod": 4, "recover_retri": 4, "recoveri": 4, "recurs": [4, 9], "redi": 0, "reduc": [0, 4, 5, 9], "redund": 8, "ref": [4, 9], "ref_inf": [0, 4, 9], "refer": [0, 2, 3, 4, 5, 6, 9], "refinf": 9, "regardless": 4, "regex": 4, "regist": [0, 2, 4, 5], "register_dataset": [0, 2], "register_hf_famili": [2, 4], "register_interfac": 2, "register_quickstart_exp": 2, "registr": 0, "registri": 0, "regular": [3, 4, 9], "reinforc": [0, 2, 4, 5], "rel": 9, "releas": [4, 5, 9], "relev": 5, "remain": 5, "remap": [2, 4, 9], "remap_keys_": 4, "remax": [0, 5], "rememb": 7, "remind": 9, "remot": [0, 3], "remov": [0, 2, 5], "reorder": 0, "reorder_to_balanced_batch": 0, "repeat": 0, "repetit": 4, "replac": [2, 3, 9], "repli": [0, 5], "replic": 5, "replica": 4, "replica_id": 4, "repositori": [1, 7, 9], "repr": 4, "repres": [0, 2, 4, 5, 9], "represent": [0, 4, 6], "request": [0, 1, 2, 3, 4, 5], "request_reply_stream": 5, "requir": [0, 1, 2, 3, 4, 5, 6, 7, 9], "rerun": 7, "reserv": 2, "resid": 5, "resid_pdrop": 4, "residu": 4, "resolv": [4, 6], "resourc": [4, 6, 7], "resp": 4, "respect": [0, 2, 3, 5, 9], "respons": [2, 3, 4, 5, 9], "result": [0, 2, 3, 4, 5], "resum": [4, 5], "retain": [0, 4, 5], "retri": 4, "return": [2, 4, 5], "return_tensor": 2, "reus": 4, "reveal": 0, "revers": 5, "revert": 5, "rew": [2, 4, 9], "rew_head_path": 4, "rew_inf": 4, "rew_lora_path": 4, "reward": [0, 4, 5, 6], "reward_output_bia": 4, "reward_output_sc": [4, 9], "rlhf": [1, 4, 6, 8], "rm": [4, 6, 7], "rm_pair": 9, "role": [2, 4, 5], "rollout": 4, "rotari": 4, "rotary_bas": 4, "rotary_interleav": 4, "rotary_sc": 4, "rotary_scaling_typ": 4, "rpc": [0, 2, 4, 5], "rstfmt": 1, "rule": 4, "run": [1, 2, 3, 4, 5, 6, 7, 9], "runner": 0, "runtim": [2, 3, 4, 6, 7, 9], "rw": 9, "rw_lora_path": 4, "rw_paired_dataset": 0, "rwconfig": [4, 6], "safe": [4, 5], "same": [0, 2, 3, 4, 5, 8, 9], "sampl": [0, 2, 4, 9], "satisfi": [2, 5], "save": [0, 2, 3, 4, 5, 9], "save_dir": [2, 4], "save_freq_epoch": 4, "save_freq_sec": 4, "save_freq_step": [4, 9], "save_to_hf": 0, "scalabl": 0, "scalar": [0, 2, 4, 9], "scale": [3, 4, 8], "scale_attn_by_inverse_layer_idx": 4, "scale_attn_weight": 4, "scenario": 2, "schedul": [0, 3, 4, 5], "scope": 5, "score": [0, 2], "score_model": 2, "score_token": 2, "script": [2, 3, 5, 6, 9], "search": [0, 4, 9], "search_engin": 0, "second": [4, 5, 8], "section": [3, 4, 5, 6, 9], "see": [0, 2, 4, 5, 9], "seed": 4, "select": 2, "self": 2, "send": 5, "sent": [4, 5], "sentiment": [0, 2, 9], "sentiment_scor": 2, "sentimentscoringinterfac": 2, "separ": [2, 3, 4, 5], "seqlen": [2, 4], "sequenc": [0, 2, 4, 5], "sequencesampl": [0, 4, 6], "sequencesplitspec": 4, "sequenti": 5, "serv": [0, 4], "set": [0, 2, 4, 5, 6, 7, 9], "setup": 3, "sever": [0, 4, 5], "sft": [0, 2, 4, 5, 6, 9], "sft_interfac": 2, "sft_lora_path": 4, "sft_po": 9, "sftconfig": [2, 4, 6, 9], "sftinterfac": 2, "sh": [0, 9], "shape": [4, 5], "shard": [2, 4, 5, 9], "share": [0, 3, 4, 5], "should": [0, 1, 2, 3, 4, 7, 9], "show": [5, 8, 9], "shown": [3, 5, 8], "shut": [3, 5], "shutdown": 6, "side": 5, "signal": [2, 4, 5], "signatur": [0, 2, 4], "similar": [0, 2, 4, 5, 9], "simpl": 6, "simpli": 0, "simplic": 3, "simplifi": [0, 5], "simpo": 4, "simultan": [0, 5], "sinc": [0, 4, 5, 9], "singl": [0, 1, 2, 4, 5, 9], "six": [4, 5, 9], "size": [0, 2, 4, 5, 8, 9], "skip_special_token": 2, "slice": [0, 4], "slide": 4, "sliding_window": 4, "slow": 4, "slurm": [0, 4, 5, 6], "small": 4, "smaller": 8, "so": [0, 2, 4, 5, 7, 9], "socket": [0, 5], "solut": [0, 8], "some": [0, 2, 3, 5], "sourc": [1, 5, 6, 8, 9], "space": 4, "spec": [4, 6], "special_tokens_map": 9, "specif": [0, 2, 4, 5, 7, 9], "specifi": [2, 3, 4, 5, 9], "sphinx": 1, "split": [0, 2, 4], "split_with_spec": 4, "src": 7, "srl": 5, "stabil": 4, "stabl": 7, "stack": 4, "stage": [4, 6], "stale": 3, "stand": 4, "standalon": [5, 6, 9], "standard": 4, "start": [0, 3, 4, 5, 7], "state": [2, 4, 5, 8], "state_dict": 0, "statist": [4, 9], "statu": 3, "step": [3, 4, 5, 6, 8], "stop": [3, 4, 5, 9], "store": [0, 2, 3, 4, 5], "str": [2, 4], "straightforward": 0, "strategi": [3, 4, 6, 8, 9], "stream": 0, "string": [0, 2, 3, 4, 9], "structur": [0, 5, 6, 9], "stuck": [3, 7], "style": 2, "sub": [0, 5], "subclass": 4, "subfold": 0, "submit": [3, 5], "subprocess": [0, 5], "subsequ": [0, 5], "subset": [2, 4], "substanti": [8, 9], "successfulli": 9, "suffici": 4, "suffix": 9, "sum": 9, "super": 2, "supervis": [4, 6], "support": [0, 3, 4, 6, 9], "suppos": [4, 5], "switch": 5, "synchron": [0, 8], "system": [0, 2, 5, 6, 9], "system_api": [0, 4, 5], "t": [2, 4, 5, 7], "tabl": 4, "tailor": 8, "take": [4, 9], "task": [5, 8], "tcp": 5, "techniqu": [4, 9], "technologi": 1, "temperatur": 4, "templat": [0, 1], "tensor": [0, 2, 4, 5, 8, 9], "term": [0, 4], "termin": [3, 4], "test": [0, 2, 6], "test_cpu_infer": 2, "test_load_data": 2, "text": [2, 4], "th": 5, "than": [0, 3, 4, 9], "thei": [0, 4, 5], "them": [0, 4, 5], "therefor": [5, 9], "thi": [0, 1, 2, 3, 4, 5, 6, 7, 9], "third": 5, "those": 4, "though": 5, "three": [0, 2, 5, 9], "through": [0, 4, 5], "throughput": [0, 5, 8, 9], "thu": 4, "tied_embed": 4, "time": [1, 4, 5, 8, 9], "time_marks0": 9, "time_marks1": 9, "time_marks2": 9, "time_marks3": 9, "time_marks4": 9, "time_marks5": 9, "time_marks6": 9, "time_marks7": 9, "timelin": 8, "tmp": 3, "to_llama": [0, 2], "togath": 5, "togeth": [0, 2, 4], "token": [0, 2, 4, 5, 9], "tokenization_utils_fast": 4, "tokenizer_config": 9, "tokenizer_path": 2, "top": 4, "top_k": [2, 4, 9], "top_p": [2, 4, 9], "topo": 4, "topologi": [0, 4, 5], "torch": [2, 4], "torchrun": [0, 5], "total": [4, 9], "total_seqlen": 2, "total_train_epoch": [4, 9], "tp": [4, 5], "track": 5, "trade": 0, "trail": 4, "trailing_shap": 4, "train": [0, 2, 4, 5, 8, 9], "train_batch": 4, "train_bs_n_seq": [4, 9], "train_path": [2, 4, 9], "train_step": [2, 4, 5], "trainabl": 5, "trainactor": 4, "traincrit": 4, "transfer": [0, 2, 4, 6], "transform": [0, 2, 4, 5, 9], "transformerengin": 7, "translat": 5, "travel": 9, "travers": 4, "trial": [0, 4, 9], "trial_nam": [2, 4, 9], "trigger": [0, 5], "trivial": 5, "true": [2, 4, 9], "truli": 1, "truncat": [2, 4], "tune": [4, 6], "tupl": 4, "tutori": [6, 9], "twice": 0, "two": [0, 2, 4, 5, 8, 9], "txt": [3, 7], "type": [0, 2, 3, 4, 5, 7, 9], "type_": [0, 2, 4], "typic": [0, 5], "u": [1, 7], "ubuntu": 7, "ultra": 4, "unbalanc": [0, 4], "undefin": 0, "under": [0, 2, 4, 5, 8], "underscor": 4, "understand": [0, 4, 6], "unexpect": 5, "unidirect": 0, "uniform": 4, "union": 4, "uniqu": [0, 2, 4, 5], "unit": [0, 2, 5], "unpack": 4, "unsur": 0, "until": [0, 3, 5], "up": [0, 4, 5, 6, 8, 9], "updat": [0, 1, 2, 4, 5, 9], "update_": 4, "upload": 7, "upon": [0, 5, 9], "us": [0, 1, 2, 3, 4, 5, 7, 9], "usag": [0, 2, 4, 5, 6], "use_adaptive_kl_ctl": 4, "use_attention_bia": 4, "use_attn_proj_bia": 4, "use_cuda_graph": 4, "use_sequence_parallel": [4, 9], "user": [0, 2, 3, 4, 5, 6, 9], "usual": [4, 5], "util": [0, 2, 4, 8, 9], "uuid": 0, "v1": 7, "valid": [0, 4, 9], "valid_bs_n_seq": [4, 9], "valid_path": [4, 9], "valu": [0, 4, 7, 9], "value_eps_clip": [4, 9], "value_norm": [4, 9], "value_norm_beta": 4, "value_norm_ep": 4, "value_norm_typ": 4, "vari": 4, "variabl": [0, 2, 3, 7], "variou": [0, 6], "vector": 2, "veri": 9, "versa": 0, "version": [2, 3, 4, 5, 7], "version_step": 4, "via": [0, 3, 4, 9], "vice": 0, "view": 3, "virtual": 5, "virual": 5, "visibl": 0, "visit": 9, "visual": 0, "visualize_dfg": [0, 5], "vllm": [0, 9], "vocab_s": 4, "vocabulari": 4, "volum": 5, "wa": 4, "wai": [4, 7, 8], "wait": [0, 3], "wandb": 4, "wandb_mod": 4, "want": [2, 7, 9], "warm": 4, "warmup_steps_proport": 4, "we": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "weight": 4, "weight_decai": 4, "well": [2, 9], "what": [2, 9], "wheel": 7, "when": [0, 2, 3, 4, 5, 8], "where": [0, 2, 3, 4, 5, 8, 9], "whether": [4, 7], "which": [0, 2, 4, 5, 9], "while": [0, 2, 4, 5, 8, 9], "whole": 5, "wide": 6, "window": 4, "wish": [0, 1], "within": [0, 4, 5, 9], "without": [2, 3, 4], "worker": [0, 2, 3, 4, 5, 6, 9], "workflow": 5, "workload": [5, 8, 9], "world": 4, "would": [3, 5, 9], "wrap": [2, 4, 5], "write": 0, "written": [0, 2, 4, 5], "x": [4, 5], "xxx": 3, "yeah": 9, "you": [0, 1, 2, 3, 4, 6, 7, 9], "your": [2, 3, 7, 9], "zero": [0, 4, 5, 9], "zero_stag": 4, "zmq": [0, 5]}, "titles": ["Code Architecture", "Contributing", "Customization", "Setting Up Distributed Experiments", "Configurations", "Implementation Details", "Welcome to ReaL\u2019s documentation!", "Installation", "Introduction", "Quickstart"], "titleterms": {"": 6, "1": 9, "2": 9, "3": 9, "30min": 9, "4x": 9, "7b": 9, "A": 2, "The": [2, 5, 9], "algorithm": [2, 5], "an": 5, "api": 0, "architectur": 0, "backend": [0, 5], "base": 0, "cluster": 3, "code": 0, "commun": [0, 5], "comparison": 8, "configur": [2, 4], "content": 6, "contribut": 1, "convers": 0, "core": 0, "custom": [0, 2], "data": [0, 2, 4, 5], "dataflow": 4, "dataset": [0, 2, 4], "detail": 5, "direct": 9, "distribut": 3, "docker": 7, "document": [1, 6], "dpo": 9, "exampl": [0, 2], "exist": [0, 8], "experi": [0, 3, 4, 5], "fine": 9, "format": 1, "from": 7, "function": 2, "get": 6, "grace": 3, "graph": 4, "how": 2, "huggingfac": [0, 2], "i": 2, "imag": 7, "implement": [0, 2, 5], "infrastructur": 5, "instal": [7, 9], "interfac": [0, 4, 5], "introduct": 8, "launch": 5, "level": 4, "limit": 8, "llama": 9, "masw": 5, "model": [0, 2, 4, 5, 9], "modul": 0, "modw": 5, "name": 0, "new": 2, "next": 9, "optim": 9, "overview": [0, 2, 5], "pack": 0, "parallel": [0, 5], "paramet": 5, "pars": 2, "perform": 8, "ppo": [2, 9], "prefer": 9, "procedur": 5, "pypi": 7, "pyxi": 3, "quickstart": [0, 9], "rai": 3, "real": 6, "realhf": 2, "realloc": 5, "represent": 5, "resolv": 0, "resourc": 3, "reward": [2, 9], "rlhf": 9, "rm": 9, "run": 0, "runtim": 5, "script": 0, "sequencesampl": 2, "set": 3, "shutdown": 3, "slurm": 3, "sourc": 7, "spec": 3, "stage": 9, "standalon": 0, "start": 6, "step": [2, 9], "strategi": [0, 5], "structur": [2, 4], "supervis": 9, "support": 2, "system": [4, 8], "test": 1, "transfer": 5, "tune": 9, "up": 3, "welcom": 6}})