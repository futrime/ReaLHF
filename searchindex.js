Search.setIndex({"alltitles": {"Cluster Spec": [[3, "cluster-spec"]], "Code Architecture": [[0, "code-architecture"]], "Configurations": [[4, "configurations"]], "Contributing": [[1, "contributing"]], "Customization": [[2, "customization"]], "Customizing Algorithms": [[2, "customizing-algorithms"]], "Customizing Datasets": [[2, "customizing-datasets"]], "Customizing Models": [[2, "customizing-models"]], "Data Structure for Interfaces and Datasets": [[4, "data-structure-for-interfaces-and-datasets"]], "Dataflow Graph": [[4, "dataflow-graph"]], "Dataset Configurations": [[4, "dataset-configurations"]], "Distributed Experiments with Ray": [[3, "distributed-experiments-with-ray"]], "Distributed Experiments with SLURM + Pyxis": [[3, "distributed-experiments-with-slurm-pyxis"]], "Docker Images": [[6, "docker-images"]], "Example: A Customized Reward Function for PPO": [[2, "example-a-customized-reward-function-for-ppo"]], "Experiment Configurations": [[4, "experiment-configurations"]], "Graceful Shutdown": [[3, "graceful-shutdown"]], "How Dataset Configuration is Parsed": [[2, "how-dataset-configuration-is-parsed"]], "Install From PyPI or Source": [[6, "install-from-pypi-or-source"]], "Installation": [[6, "installation"], [8, "installation"]], "Introduction": [[7, "introduction"]], "Limitations of Existing Systems": [[7, "limitations-of-existing-systems"]], "Model Configurations": [[4, "model-configurations"]], "Overview": [[2, "overview"], [2, "id1"], [2, "id2"]], "Performance Comparison": [[7, "performance-comparison"]], "Quickstart": [[8, "quickstart"]], "RLHF with 4x LLaMA-7B in 30min": [[8, "rlhf-with-4x-llama-7b-in-30min"]], "Ray Resources": [[3, "ray-resources"]], "Setting Up Distributed Experiments": [[3, "setting-up-distributed-experiments"]], "Stage 1: Supervised Fine-Tuning": [[8, "stage-1-supervised-fine-tuning"]], "Stage 2.1: Reward Modeling (RM)": [[8, "stage-2-1-reward-modeling-rm"]], "Stage 2.2: Direct Preference Optimization (DPO)": [[8, "stage-2-2-direct-preference-optimization-dpo"]], "Stage 3: PPO": [[8, "stage-3-ppo"]], "Steps for Implementing a New Dataset": [[2, "steps-for-implementing-a-new-dataset"]], "Steps to Support a New HuggingFace Model": [[2, "steps-to-support-a-new-huggingface-model"]], "The Next Step": [[8, "the-next-step"]], "Welcome to ReaL\u2019s documentation!": [[5, "welcome-to-real-s-documentation"]], "\u2b50 Contents \u2b50": [[5, "contents"]], "\ud83d\ude80 Get Started \ud83d\ude80": [[5, "get-started"]]}, "docnames": ["arch", "contributing", "customization", "distributed", "expconfig", "index", "install", "intro", "quickstart"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["arch.rst", "contributing.rst", "customization.rst", "distributed.rst", "expconfig.rst", "index.rst", "install.rst", "intro.rst", "quickstart.rst"], "indexentries": {"allocationconfig (class in realhf)": [[4, "realhf.AllocationConfig", false]], "bs (realhf.sequencesample property)": [[4, "realhf.SequenceSample.bs", false]], "commonexperimentconfig (class in realhf)": [[4, "realhf.CommonExperimentConfig", false]], "cuda() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.cuda", false]], "dpoconfig (class in realhf)": [[4, "realhf.DPOConfig", false]], "evaluate() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.evaluate", false]], "experimentsaveevalcontrol (class in realhf)": [[4, "realhf.ExperimentSaveEvalControl", false]], "from_default() (realhf.sequencesample class method)": [[4, "realhf.SequenceSample.from_default", false]], "gather() (realhf.sequencesample class method)": [[4, "realhf.SequenceSample.gather", false]], "generate() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.generate", false]], "generationconfig (class in realhf)": [[4, "realhf.GenerationConfig", false]], "generationhyperparameters (class in realhf)": [[4, "realhf.GenerationHyperparameters", false]], "get_split_spec() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.get_split_spec", false]], "inference() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.inference", false]], "meta() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.meta", false]], "mfcdef (class in realhf)": [[4, "realhf.MFCDef", false]], "modelfamily (class in realhf)": [[4, "realhf.ModelFamily", false]], "modelinterface (class in realhf)": [[2, "realhf.ModelInterface", false]], "modeltrainevalconfig (class in realhf)": [[4, "realhf.ModelTrainEvalConfig", false]], "optimizerconfig (class in realhf)": [[4, "realhf.OptimizerConfig", false]], "pairedcomparisondatasetconfig (class in realhf)": [[4, "realhf.PairedComparisonDatasetConfig", false]], "parallelismconfig (class in realhf)": [[4, "realhf.ParallelismConfig", false]], "ppoconfig (class in realhf)": [[4, "realhf.PPOConfig", false]], "ppohyperparameters (class in realhf)": [[4, "realhf.PPOHyperparameters", false]], "promptanswerdatasetconfig (class in realhf)": [[4, "realhf.PromptAnswerDatasetConfig", false]], "promptonlydatasetconfig (class in realhf)": [[4, "realhf.PromptOnlyDatasetConfig", false]], "realmodelconfig (class in realhf)": [[4, "realhf.ReaLModelConfig", false]], "remap_keys_() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.remap_keys_", false]], "rwconfig (class in realhf)": [[4, "realhf.RWConfig", false]], "save() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.save", false]], "sequencesample (class in realhf)": [[4, "realhf.SequenceSample", false]], "sftconfig (class in realhf)": [[4, "realhf.SFTConfig", false]], "split() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.split", false]], "split_with_spec() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.split_with_spec", false]], "train_step() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.train_step", false]], "unpack() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.unpack", false]], "update_() (realhf.sequencesample method)": [[4, "realhf.SequenceSample.update_", false]]}, "objects": {"realhf": [[4, 0, 1, "", "AllocationConfig"], [4, 0, 1, "", "CommonExperimentConfig"], [4, 0, 1, "", "DPOConfig"], [4, 0, 1, "", "ExperimentSaveEvalControl"], [4, 0, 1, "", "GenerationConfig"], [4, 0, 1, "", "GenerationHyperparameters"], [4, 0, 1, "", "MFCDef"], [4, 0, 1, "", "ModelFamily"], [2, 0, 1, "", "ModelInterface"], [4, 0, 1, "", "ModelTrainEvalConfig"], [4, 0, 1, "", "OptimizerConfig"], [4, 0, 1, "", "PPOConfig"], [4, 0, 1, "", "PPOHyperparameters"], [4, 0, 1, "", "PairedComparisonDatasetConfig"], [4, 0, 1, "", "ParallelismConfig"], [4, 0, 1, "", "PromptAnswerDatasetConfig"], [4, 0, 1, "", "PromptOnlyDatasetConfig"], [4, 0, 1, "", "RWConfig"], [4, 0, 1, "", "ReaLModelConfig"], [4, 0, 1, "", "SFTConfig"], [4, 0, 1, "", "SequenceSample"]], "realhf.ModelInterface": [[2, 1, 1, "", "evaluate"], [2, 1, 1, "", "generate"], [2, 1, 1, "", "inference"], [2, 1, 1, "", "save"], [2, 1, 1, "", "train_step"]], "realhf.SequenceSample": [[4, 2, 1, "", "bs"], [4, 1, 1, "", "cuda"], [4, 1, 1, "", "from_default"], [4, 1, 1, "", "gather"], [4, 1, 1, "", "get_split_spec"], [4, 1, 1, "", "meta"], [4, 1, 1, "", "remap_keys_"], [4, 1, 1, "", "split"], [4, 1, 1, "", "split_with_spec"], [4, 1, 1, "", "unpack"], [4, 1, 1, "", "update_"]]}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property"}, "terms": {"": [2, 3, 4, 6, 8], "0": [2, 3, 4, 7, 8], "00": 8, "00001": 8, "00002": 8, "00003": 8, "00004": 8, "00005": 8, "00006": 8, "00007": 8, "00008": 8, "00009": 8, "00010": 8, "00011": 8, "00012": 8, "00013": 8, "00014": 8, "007": 8, "01": [3, 4], "02": [3, 4], "03": [4, 8], "04": 6, "05": 4, "051": 8, "07": 4, "081": 8, "083": 8, "094": 8, "1": [2, 3, 4, 5, 6], "10": [4, 6, 8], "1000": [2, 8], "10000": [3, 4], "1024": [4, 8], "10gb": 3, "128": 8, "13": [4, 8], "13b": 7, "14": 8, "141": 7, "15": [4, 8], "152": 7, "17": [4, 7], "19": 8, "1d": 4, "1e": 4, "2": [4, 5, 6, 7], "20": 4, "200": 4, "20240618": 8, "216": 8, "22": 6, "23": 6, "256": [4, 8], "26": 8, "294": 8, "3": [4, 5], "30min": 5, "312": 8, "32": 8, "34": 8, "34b": 7, "38": 8, "387": 8, "39": 8, "393": 8, "3d": [2, 4, 8], "3wd0": 4, "4": [4, 6, 7, 8], "400": 7, "42": 4, "46": 8, "4x": 5, "5": [4, 7, 8], "50": 8, "5000": 8, "512": 8, "52": 8, "53": 8, "54": 8, "56": 8, "574": 8, "6": 4, "628": 8, "6379": 3, "7": [4, 8], "70b": 7, "7b": [4, 5, 7], "8": [4, 6, 7, 8], "9": [2, 4, 8], "906": 8, "95": 4, "99995": 4, "A": [3, 4, 5, 6, 8], "As": [3, 4, 8], "At": 2, "By": [3, 7], "For": [2, 3, 4, 5, 8], "If": [1, 2, 3, 4, 5, 6, 8], "In": [2, 3, 4, 7, 8], "It": [2, 3, 4, 8], "NOT": 4, "No": [3, 4, 6], "On": [3, 6], "One": 4, "Or": 6, "The": [2, 3, 4, 5, 6, 7], "There": 2, "These": [2, 5, 8], "To": [2, 3, 6], "Will": 4, "With": [4, 8], "_": [2, 4], "__getitem__": 2, "__init__": 2, "__post_init__": 2, "_class": [4, 8], "_g": 4, "_post_hook": 4, "_pre_hook": 4, "_resolve_seqlen_from_kei": 4, "a100": 3, "abbrevi": 4, "about": [1, 3, 8], "abov": [2, 3, 4, 8], "abs_position_embedding_offset": 4, "absolut": 4, "access": 3, "accommod": 8, "accord": [3, 4, 6, 8], "accumul": 4, "accur": 4, "across": 8, "action": 4, "activ": 4, "activation_funct": 4, "actor": [2, 4, 7, 8], "actor_gen": 4, "actor_train": [4, 8], "actortrain": 8, "actual": [2, 4], "ad": 4, "adam": 4, "adapt": 4, "add": 3, "addit": [2, 3, 4, 8], "address": [3, 7], "adjust": 6, "adopt": 8, "adv_norm": [4, 8], "advanc": [4, 5], "advantag": 4, "after": [3, 4, 6, 8], "again": 4, "aigc": 8, "algorithm": [4, 5, 8], "align": 4, "all": [2, 3, 4, 6, 8], "alloc": [3, 4, 8], "allocation_mod": [4, 8], "allocation_use_cach": 4, "allocationconfig": [4, 5], "allow": 6, "along": 2, "also": [2, 4, 6, 7, 8], "altern": 7, "amend": 4, "among": [4, 8], "amount": 4, "an": [2, 3, 4, 5, 6, 7, 8], "analysi": 2, "ani": [1, 3, 4, 8], "anneal": 4, "anoth": [3, 4], "answer": [4, 8], "api": [2, 4], "app": [2, 3, 4, 8], "append": 3, "appli": [2, 4, 7], "applic": [1, 2, 8], "apply_rotari": 4, "approxim": 8, "ar": [2, 3, 4, 5, 7, 8], "arbitrari": [3, 4], "architectur": 5, "area": 7, "arg": 2, "argument": [2, 4], "art": 7, "assert": 4, "assign": [7, 8], "assist": 1, "assum": [3, 4, 8], "asymmetr": 7, "attent": 4, "attention_mask": 2, "attn_pdrop": 4, "attribut": [4, 8], "auto": 4, "automat": [2, 3, 4, 8], "automodelforcausallm": 8, "automodelforsequenceclassif": 2, "autotoken": 2, "avail": [3, 4, 5, 6], "averag": 4, "avoid": 8, "b": [2, 4], "back": 2, "backend": [2, 4], "backward": 8, "balanc": 4, "balanced_dp": 4, "bar": 7, "base": [4, 7], "bash": [6, 8], "basic": 5, "batch": [2, 4, 8], "batch_decod": 2, "becaus": [2, 4, 7, 8], "becom": 3, "been": 8, "befor": [3, 4], "being": 8, "benchmark": 4, "benchmark_step": 4, "benefit": 4, "berlin": 8, "bert": 2, "besid": [5, 8], "best": [1, 4, 8], "beta": 4, "beta1": 4, "beta2": 4, "between": [2, 7, 8], "bf16": 4, "bia": 4, "bin": 8, "bind": 6, "block": [2, 4], "boilerpl": 4, "bool": 4, "both": [4, 8], "break": 2, "brief": 5, "buffer": 4, "bug": 4, "build": 6, "built": [6, 8], "c": 6, "cach": [3, 4], "call": [2, 3, 4, 7, 8], "can": [1, 2, 3, 4, 6, 7, 8], "capit": 8, "case": [2, 4], "cat": 8, "caus": [7, 8], "caution": 4, "cd": 6, "cfg": 2, "chang": [2, 3, 4, 8], "chat": [4, 7], "check": [2, 3, 4, 6, 8], "checkpoint": [2, 3, 4, 8], "choos": 7, "class": [2, 4], "classmethod": 4, "clean": 4, "cli": [3, 4], "clip": 4, "clone": [6, 8], "cluster": [4, 5, 6, 8], "cluster_config": 3, "cluster_nam": 3, "cluster_spec_path": 3, "cluster_typ": 3, "code": [1, 2, 4, 5, 6], "codellama": 7, "coeffici": 4, "com": [3, 6], "com08": 4, "combin": 4, "come": 4, "comma": 3, "command": [2, 3, 4, 6, 8], "commandlin": 4, "comment": 8, "common": [4, 8], "commonexperimentconfig": [4, 5], "commonli": 2, "commun": [1, 7, 8], "comparison": [4, 5, 8], "compil": [2, 6], "complet": [4, 7, 8], "complex": 8, "compos": [4, 7, 8], "comput": [2, 4, 7, 8], "concaten": [2, 4], "conceptu": 2, "concret": 4, "concurr": 7, "condit": 4, "config": [2, 4, 8], "config_api": 2, "configur": [3, 5, 8], "connect": [3, 4], "consequ": 8, "consid": 2, "consist": [2, 4], "consol": 8, "constant": 4, "construct": [2, 4], "constructor": 2, "consum": [3, 6, 8], "consumpt": 8, "contact": 1, "contain": [2, 4, 6], "context": [4, 8], "contigu": [2, 4], "contribut": 5, "control": [3, 4, 6, 8], "conveni": 8, "converg": 8, "convers": 2, "convert": [2, 4], "core": [2, 3, 4], "correctli": 3, "correspond": [2, 4, 8], "cosin": 4, "counter": 4, "cover": [5, 8], "cpu": [3, 4, 6], "cpu_imag": 3, "creat": [2, 3, 4], "critic": [2, 4, 7, 8], "critic_inf": 4, "critic_train": 4, "ctl": 8, "cuda": [2, 4, 6], "cumul": 4, "current": [1, 3, 4], "custom": [4, 5, 8], "data": [2, 5, 8], "data_api": 2, "data_parallel_s": [4, 8], "dataclass": [2, 8], "dataflow": [2, 5], "dataload": 2, "dataset": [5, 8], "dataset_path": 2, "debug": 4, "decai": 4, "decid": 4, "decod": [2, 4], "deepspe": [4, 7, 8], "deepspeedchat": 7, "def": 2, "default": [3, 4, 8], "default_mount": 3, "defin": 5, "degre": [4, 7], "demonstr": 2, "denomin": 4, "denorm": 4, "dep": 6, "depend": [2, 4, 6, 7], "deploi": 8, "deploy": 6, "describ": 2, "design": [4, 8], "destin": [6, 8], "detail": [2, 3, 8], "detect": 3, "dev": 4, "develop": [4, 6, 8], "devic": [3, 4], "device_mesh": 4, "dfg": 4, "dict": [2, 4], "dictionari": [3, 4, 8], "differ": [4, 7, 8], "digraph": 4, "dimens": 4, "dir": 4, "direct": [4, 5], "directli": [1, 6, 8], "directori": [3, 4, 6, 8], "disabl": 4, "discount": 4, "distinct": [4, 8], "distinguish": 8, "distribut": [4, 5, 7, 8], "diverg": 4, "divers": 4, "do": [1, 2, 3, 4, 5], "do_layernorm_befor": 4, "docker": [3, 4, 5], "dockerfil": 6, "document": [2, 3], "doe": [2, 3, 4, 8], "don": [2, 4, 6], "done": 8, "down": [3, 4], "download": 8, "dp": 4, "dp_size": 4, "dpo": [4, 5], "dpoconfig": [4, 5], "driver": 3, "drop": 4, "dropout": 4, "dschat": 4, "dst": 6, "dtype": 4, "due": 8, "dump": 8, "dure": [2, 4], "dynam": 7, "e": [2, 3, 4, 5, 6, 7, 8], "each": [2, 4, 7, 8], "earli": 4, "early_stop_imp_ratio": 4, "easiest": 6, "easili": 4, "edg": [2, 4], "edit": 6, "effect": [4, 7], "effici": [2, 4, 7, 8], "either": [3, 4], "elast": 3, "elimin": 7, "embd_pdrop": 4, "embed": [2, 4], "empow": 1, "empti": 4, "enabl": [1, 4, 7], "enable_bf16": 4, "enable_fp16": 4, "encod": 2, "end": [2, 3], "engin": [4, 8], "enough": 3, "enroot": 4, "ensur": 3, "entir": [4, 7], "entri": 8, "environ": [3, 6], "ep": 4, "epoch": [4, 8], "epoch7epochstep5globalstep50": 8, "eps_clip": 4, "epsilon": 4, "equal": 4, "error": 4, "estim": [4, 7], "etc": [3, 4], "eval": 2, "eval_dataload": 2, "eval_freq_epoch": [4, 8], "eval_freq_sec": 4, "eval_freq_step": 4, "evalu": [2, 4], "even": 4, "everi": [2, 3, 4, 7], "exactli": [4, 8], "exampl": [3, 4, 5, 8], "exce": 4, "except": [2, 8], "exclus": 4, "execut": [2, 4, 7, 8], "exist": [5, 6], "exp": 4, "exp_ctrl": [4, 8], "experi": [2, 5, 6, 8], "experiment_nam": [2, 4, 8], "experimentconfig": 2, "experimentsaveevalcontrol": [4, 5], "explan": 8, "exponenti": 4, "export": 6, "express": 3, "extens": 6, "extent": 6, "extern": 2, "factor": 4, "factori": 4, "fail": 4, "fals": 4, "famili": 4, "familiar": 8, "fast": 8, "faster": [4, 8], "favor": 8, "feasibl": 8, "few": 3, "field": [2, 4, 8], "figur": [2, 7, 8], "file": [2, 3, 4, 8], "fileroot": 3, "fill": 4, "filter": 4, "final": 2, "find": [2, 4, 8], "fine": 5, "finish": 8, "first": [2, 4, 6, 7, 8], "flash": 4, "flash_attn": 6, "flexibl": 3, "float": [2, 4], "folder": 2, "follow": [2, 3, 4, 6, 7, 8], "forc": 4, "force_no_logits_mask": 4, "forget": 2, "form": [4, 8], "format": [4, 8], "former": 8, "forth": 2, "forward": 8, "found": [2, 4, 8], "four": [4, 8], "fp16": 4, "framework": 8, "franc": 8, "free": 4, "frequenc": [4, 8], "from": [2, 4, 5, 7, 8], "from_default": [2, 4], "from_hf": [2, 4], "from_llama": 2, "from_pretrain": [2, 8], "frozen": 8, "full": 7, "fulli": 8, "function": [4, 5, 8], "fuse": 4, "fw": 8, "g": [2, 3, 4, 5, 6, 7, 8], "g1": 3, "g2": 3, "g8": 3, "gae": 4, "gae_lambda": 4, "garrett4wad": 6, "gather": 4, "gelu": 4, "gemma": 4, "gen": [4, 8], "gen_param": 4, "gener": [2, 4, 7, 8], "generationconfig": [4, 5], "generationhyperparamet": [4, 5], "get": [2, 3, 4], "get_split_spec": 4, "git": 6, "github": [6, 8], "given": [3, 4, 8], "global": 8, "goe": 4, "good": 4, "gpt": 4, "gpt2": 4, "gpu": [2, 3, 4, 6, 7, 8], "gpu_imag": 3, "gpu_type_from_node_nam": 3, "grace": 5, "gradient": 4, "gradient_accumulation_fus": 4, "gradient_checkpoint": [4, 8], "grai": 7, "graph": [2, 5], "greedi": 4, "ha": [2, 3, 4, 8], "half": 8, "handl": 8, "hashabl": 4, "have": [1, 3, 4, 5, 8], "head": [3, 4, 8], "head_dim": 4, "help": [1, 8], "helper": [2, 4], "here": [6, 8], "hesit": 1, "heurist": [4, 8], "hf": 4, "hidden": 4, "hidden_dim": 4, "highest": 4, "highlight": 4, "home": 3, "homogen": 3, "hood": 4, "hope": 1, "host": 3, "hostfil": 4, "hour": [7, 8], "how": [4, 5, 8], "howev": [3, 4, 7], "http": 6, "hub": 2, "huggingfac": [4, 5, 8], "hydra": [4, 8], "hyperparamet": [4, 8], "i": [1, 3, 4, 5, 6, 7, 8], "id": [2, 4], "idea": 7, "ident": 4, "identifi": [2, 4], "idx": 2, "ignor": 4, "ignore_worker_error": 4, "illustr": [2, 4, 8], "imag": [3, 4, 5], "image_nam": 4, "imdb": 2, "impl": 2, "implement": [4, 5], "impli": 4, "implicitli": 8, "import": [3, 4], "improv": [1, 4, 7, 8], "includ": [2, 3, 5, 8], "increas": [3, 4, 7], "independ": [4, 8], "index": [4, 8], "indic": [2, 8], "individu": [4, 8], "inf_reward_rpc": 2, "infer": [2, 4, 8], "info": 8, "inform": 3, "infref": 4, "infreward": 4, "infvalu": 4, "init": 3, "init_critic_from_actor": 4, "initi": [2, 4, 8], "initial_setup": 2, "inner": 4, "inplac": 4, "input": [2, 4], "input_": 2, "input_id": 2, "input_kei": 4, "input_key_remap": 4, "insert": 4, "insid": [4, 6], "instal": [3, 5], "instead": 4, "instrctgpt": 8, "instruct": [2, 3, 6, 8], "int": 4, "integ": 3, "interest": 4, "interfac": [2, 5], "interface_impl": [2, 4], "interface_typ": [2, 4], "interleav": 4, "intermedi": 4, "intermediate_dim": 4, "interv": 4, "introduc": 4, "introduct": [5, 8], "inttensor": 4, "invers": 4, "involv": [2, 8], "io": 6, "ip": 3, "is_crit": [4, 8], "is_rew_lora": 4, "is_rw_lora": 4, "is_sft_lora": 4, "isol": 6, "issu": [1, 2, 3], "iter": [2, 4, 7, 8], "its": [2, 3, 4, 5], "job": [3, 6], "json": [3, 4, 8], "jsonl": [4, 8], "just": 4, "k": 4, "keep": 4, "kei": [2, 4, 7, 8], "kernel": 4, "keypoint": 4, "kill": 3, "kl": [4, 8], "kl_ctl": [2, 4, 8], "know": [3, 4], "known": 4, "l": 8, "lambda": 4, "larg": [2, 4, 8], "larger": 6, "largest": [4, 7], "last": 4, "latest": 6, "latter": 8, "launch": [2, 3, 4, 6, 8], "layer": [2, 4, 8], "layer_norm_epsilon": 4, "layer_norm_typ": 4, "lead": [4, 6, 7], "learn": [4, 5, 8], "leav": [3, 4], "length": [2, 4], "let": [2, 4, 8], "light": 7, "like": [2, 3, 4, 8], "limit": 5, "line": [2, 4, 8], "linear": [4, 8], "list": [3, 4, 8], "llama": [2, 4, 5, 7], "llm": [1, 4, 8], "lm": 4, "load": [2, 8], "load_and_eval_rw": 8, "loadabl": 8, "local": [3, 4, 5, 6, 8], "locat": [2, 8], "log": [3, 4, 8], "log_return_valu": 4, "logit": [2, 4], "logprob": 4, "longer": 4, "look": 4, "loop": 4, "lora": 4, "loraconfig": 4, "loss": 8, "low": 3, "lr": 4, "lr1e": 4, "lr_scheduler_typ": 4, "lustr": 8, "m": [2, 3, 4, 8], "ma": 4, "machin": [3, 6], "mai": [4, 8], "main": [4, 8], "major": [7, 8], "make": 8, "manag": [3, 4, 8], "mandatori": 5, "mani": 4, "manual": [3, 4, 5, 8], "map": [2, 3], "mark": 4, "mask": 4, "master": [3, 4, 8], "master_work": 8, "masterwork": 2, "match": 3, "matter": 4, "max_job": 6, "max_length": 2, "max_new_token": [4, 8], "max_pairs_per_prompt": [4, 8], "max_prompt_len": [4, 8], "max_reward_clip": 4, "max_seqlen": [2, 4, 8], "maxim": [7, 8], "maximum": 4, "mean": [3, 4], "megatron": 4, "mem": 3, "member": 4, "memori": [2, 3, 4, 6, 8], "mention": 3, "mesh": 4, "messag": 3, "met": 4, "meta": 4, "metadata": [2, 4], "method": 2, "metric": 8, "mfc": [2, 4], "mfcdef": [2, 4, 5], "micro": 2, "min_lr_ratio": 4, "min_new_token": [4, 8], "min_siz": 4, "minibatch": 4, "minimum": 4, "minut": 8, "mlp": 4, "mlp_type": 4, "mode": [3, 4, 8], "model": [3, 5, 7], "model_api": [2, 4], "model_nam": [2, 4], "model_parallel_s": [4, 8], "model_path": 4, "model_rpc": 2, "model_typ": 4, "model_work": [2, 8], "modelbackend": 2, "modelfamili": [4, 5], "modelinterfac": [2, 4], "modelinterfaceabstract": [2, 4], "modelinterfacetyp": 4, "modelnam": 4, "modeltrainevalconfig": [4, 5], "modelwork": 2, "modifi": [2, 4, 6, 8], "monitor": 2, "more": [2, 3, 6, 8], "moreov": 8, "most": [4, 8], "mount": [3, 6], "move": [4, 8], "movi": 8, "mpi": 4, "multipl": [4, 5, 8], "must": [4, 6], "mutual": 4, "mw": 2, "my": [2, 3], "my_trial": 4, "myppoconfig": 2, "n_gpus_per_nod": [3, 4, 8], "n_kv_head": 4, "n_layer": 4, "n_node": [3, 4, 8], "n_posit": 4, "n_q_head": 4, "n_seq": 4, "name": [2, 3, 4, 8], "narrow": 4, "necessari": [2, 3], "need": [2, 3, 4], "neg": [2, 8], "neg_answ": [4, 8], "networkx": 4, "new": [3, 4, 5], "newli": [4, 8], "next": [3, 5, 6], "nf": 3, "nn": 2, "no_grad": 2, "node": [2, 3, 4, 5, 6, 7, 8], "node01": [3, 4], "node02": [3, 4], "node03": 4, "node07": 4, "node_name_prefix": 3, "node_type_from_node_nam": 3, "nodelist": 4, "non": 4, "none": [4, 8], "normal": 4, "normalize_emb": 4, "note": [2, 3, 8], "noth": 4, "now": [2, 3, 4, 8], "null": [2, 8], "num": 3, "number": [4, 6, 7, 8], "nvcr": 6, "nvida": 6, "nvidia": 6, "nx": 4, "object": [2, 4, 5, 8], "observ": 7, "obtain": 4, "occupi": 4, "occur": 4, "offer": 6, "offload": [2, 4, 8], "offloadhook": 4, "offset": 4, "often": 7, "omit": 4, "onc": [2, 8], "one": [2, 3, 4], "onli": [2, 3, 4, 6], "onlin": 2, "oom": 6, "open": [1, 7], "openpsi": 6, "openrlhf": 7, "opt": 4, "optim": [4, 5], "optimizerconfig": [4, 5], "option": [2, 3, 4, 8], "order": 4, "ordinari": 8, "origin": 2, "other": [2, 4], "otherwis": [3, 4], "our": [1, 2, 3, 4, 7, 8], "out": [4, 8], "output": [2, 4, 8], "output_kei": 4, "output_key_remap": 4, "outsid": 6, "outter": 4, "over": [7, 8], "overhead": [4, 7, 8], "overrid": 4, "overview": 5, "overwritten": 8, "p": 4, "pack": 4, "packag": [3, 6], "packed_input_id": 4, "pad": [2, 4], "page": 4, "pair": 4, "pairedcomparisondatasetconfig": [2, 4, 5], "pairwis": [4, 8], "paper": 8, "parallel": [2, 3, 4, 6, 7, 8], "parallelismconfig": [4, 5], "paramet": [2, 4, 7, 8], "pars": 5, "part": 4, "partit": 4, "pass": [2, 8], "path": [2, 3, 4, 6, 8], "penalti": 4, "per": 4, "perform": [2, 4, 5, 8], "piec": 4, "pip": 6, "pipe": [4, 8], "pipe_data": 4, "pipe_model": 4, "pipelin": [2, 4, 7, 8], "pipeline_parallel_s": [4, 8], "pkl": 8, "placehold": 4, "plan": [4, 8], "pleas": [1, 2, 4, 5, 6, 8], "plugin": [3, 4], "point": 2, "port": 3, "pos_answ": [4, 8], "posit": [2, 4, 8], "possibl": 4, "post_hook": 2, "potenti": [4, 6], "ppo": [3, 4, 5], "ppo_exp": 4, "ppo_n_minibatch": [4, 8], "ppo_prompt": 8, "ppo_senti": 2, "ppoconfig": [2, 4, 5], "ppohyperparamet": [4, 5, 8], "practic": [4, 8], "pre": [6, 8], "predict": 4, "prefer": [4, 5, 6], "prefix": 3, "prepar": 8, "present": 5, "previou": 7, "previous": 4, "price": 4, "primari": [4, 8], "primarili": 2, "prior": 7, "probabl": [4, 8], "problem": 4, "proce": 8, "procedur": 8, "proceed": 5, "process": [3, 4, 7, 8], "produc": 4, "profil": [4, 7], "project": [4, 6, 8], "promot": 4, "prompt": [3, 4, 8], "prompt_answ": 2, "prompt_answer_dataset": 2, "promptanswerdataset": 2, "promptanswerdatasetconfig": [2, 4, 5], "promptonlydatasetconfig": [2, 4, 5], "properli": 8, "properti": [2, 4], "proport": 4, "provid": [2, 3, 4, 6, 8], "pt": 2, "pull": [1, 6], "pure": 4, "purpl": 7, "py": [2, 8], "py3": 6, "pypi": [3, 5], "python": 8, "python3": [2, 3, 4, 8], "pytorch": [2, 6], "pytorch_model": 8, "pyxi": [4, 5], "qkv": 4, "queri": 4, "question": 1, "quickstart": [2, 3, 4, 5, 6], "qwen2": 4, "r": 6, "rai": [4, 5], "rais": [1, 4], "random": 4, "randomli": 4, "rang": 2, "rank": 4, "rate": [4, 8], "rather": 4, "ratio": 4, "raw": 4, "re": [2, 8], "read": [4, 5], "real": [2, 3, 4, 6, 7, 8], "real_cuda": 6, "real_llm_api": 2, "real_no_ext": 6, "real_vers": 6, "realhf": [2, 3, 4, 6, 8], "realloc": [2, 4, 7], "realmodel": [2, 4], "realmodelconfig": [2, 4, 5], "reason": 2, "receiv": 4, "recogn": 4, "recommend": [3, 4, 5, 6], "record": 2, "recov": 4, "recover_mod": 4, "recover_retri": 4, "recoveri": 4, "recurs": [4, 8], "reduc": [4, 8], "redund": 7, "ref": [4, 8], "ref_inf": [4, 8], "refer": [2, 3, 4, 5, 8], "refinf": 8, "regist": [2, 4], "register_dataset": 2, "register_hf_famili": [2, 4], "register_interfac": 2, "register_quickstart_exp": 2, "regular": [3, 4, 8], "rel": 8, "releas": 8, "remap": [2, 4, 8], "remap_keys_": 4, "rememb": 6, "remind": 8, "remot": 3, "remov": 2, "repeatit": 4, "replac": [2, 3, 8], "replica": 4, "repositori": [1, 6, 8], "repres": [2, 4, 8], "represent": 4, "request": [1, 2, 3], "requir": [2, 3, 4, 5, 6, 8], "rerun": 6, "reserv": 2, "resid_pdrop": 4, "residu": 4, "resolv": 4, "resourc": [4, 5, 6], "resp": 4, "respect": [2, 3, 8], "respons": [3, 4, 8], "restrict": 4, "result": [3, 4], "resum": 4, "retri": 4, "return": [2, 4], "return_tensor": 2, "reus": 4, "rew": [2, 4, 8], "rew_head_path": 4, "rew_inf": 4, "rew_lora_path": 4, "reward": [4, 5], "reward_output_bia": 4, "reward_output_sc": [4, 8], "rlhf": [1, 4, 5, 7], "rm": [4, 5, 6], "rm_pair": 8, "role": 2, "rollout": 4, "rotari": 4, "rotary_bas": 4, "rotary_interleav": 4, "rotary_sc": 4, "rotary_scaling_typ": 4, "rpc": [2, 4], "rule": 4, "run": [2, 3, 4, 5, 6, 8], "runtim": [3, 4, 6, 8], "rw": 8, "rw_lora_path": 4, "rwconfig": [4, 5], "sai": 4, "same": [3, 4, 7, 8], "sampl": [2, 4, 8], "satisfi": 2, "save": [2, 4, 8], "save_dir": 2, "save_freq_epoch": 4, "save_freq_sec": 4, "save_freq_step": [4, 8], "scalar": 8, "scale": [3, 4, 7], "scale_attn_by_inverse_layer_idx": 4, "scale_attn_weight": 4, "scenario": 2, "schedul": [3, 4], "score": 2, "score_model": 2, "score_token": 2, "script": [2, 3, 8], "search": [4, 8], "second": [4, 7], "section": [3, 4, 5, 8], "see": [2, 4, 8], "seed": 4, "select": 2, "self": 2, "sentiment": [2, 8], "sentiment_scor": 2, "sentimentscoringinterfac": 2, "separ": 3, "seq": 4, "seqlen": [2, 4], "sequenc": [2, 4], "sequencesampl": [2, 4, 5], "sequencesplitspec": 4, "serv": 4, "serval": 4, "set": [4, 5, 6, 8], "setup": 3, "sever": 4, "sft": [2, 4, 5, 8], "sft_interfac": 2, "sft_lora_path": 4, "sft_po": 8, "sftconfig": [2, 4, 5, 8], "sftinterfac": 2, "sh": 8, "shape": 4, "shard": [2, 8], "share": [3, 4], "should": [2, 3, 4, 6, 8], "show": [7, 8], "shown": [3, 7], "shut": 3, "shutdown": 5, "signal": [2, 4], "signatur": 2, "similar": [2, 4, 8], "simpl": 5, "simplic": 3, "simpo": 4, "sinc": [4, 8], "singl": [2, 4, 8], "six": [4, 8], "size": [4, 7, 8], "skip_special_token": 2, "slice": 4, "slide": 4, "sliding_window": 4, "slow": 4, "slurm": [4, 5], "smaller": 7, "so": [2, 4, 6, 8], "solut": 7, "some": [2, 3, 4], "sourc": [1, 5, 7, 8], "space": 4, "spec": [4, 5], "special": 4, "special_tokens_map": 8, "specif": [2, 4, 6, 8], "specifi": [2, 3, 4, 8], "split": 4, "split_with_spec": 4, "src": 6, "stabil": 4, "stabl": 6, "stage": [4, 5], "stale": 3, "standalon": 8, "start": [3, 4, 6], "state": [2, 4, 7], "statist": 8, "statu": 3, "step": [3, 4, 5, 7], "stop": [3, 4, 8], "store": [2, 3, 4], "str": [2, 4], "strategi": [3, 4, 7, 8], "string": [3, 4, 8], "structur": [5, 8], "stuck": [3, 6], "style": 2, "subclass": 4, "submit": 3, "subset": 4, "substanti": [7, 8], "successfulli": 8, "suffici": 4, "suffix": 8, "sum": 8, "super": 2, "supervis": 5, "support": [3, 4, 5, 8], "sure": 4, "synchron": 7, "syncparamhook": 4, "system": [2, 4, 5, 8], "system_api": [2, 4], "t": [2, 4, 6], "tailor": 7, "take": 8, "task": 7, "techniqu": [4, 8], "technologi": 1, "temperatur": 4, "templat": 1, "tensor": [4, 7, 8], "term": 4, "termin": [3, 4], "test": 2, "test_cpu_infer": 2, "text": [2, 4], "than": [3, 4, 8], "them": 4, "therefor": 8, "thi": [1, 2, 3, 4, 5, 6, 8], "three": [2, 8], "through": 4, "throughput": 7, "thu": 4, "tied_embed": 4, "time": [4, 7, 8], "time_marks0": 8, "time_marks1": 8, "time_marks2": 8, "time_marks3": 8, "time_marks4": 8, "time_marks5": 8, "time_marks6": 8, "time_marks7": 8, "timelin": 7, "tmp": 3, "to_llama": 2, "token": [2, 4, 8], "tokenizer_config": 8, "tokenizer_path": 2, "top": 4, "top_k": [2, 4, 8], "top_p": [2, 4, 8], "torch": [2, 4], "total": [4, 8], "total_train_epoch": [4, 8], "trail": 4, "trailing_shap": 4, "train": [2, 4, 7, 8], "train_bs_n_seq": [4, 8], "train_path": [2, 4, 8], "train_step": [2, 4], "trainactor": 4, "traincrit": 4, "transfer": 4, "transform": [2, 4, 8], "transformerengin": 6, "travel": 8, "trial": [4, 8], "trial_nam": [2, 4, 8], "true": [2, 4, 8], "truli": 1, "truncat": [2, 4], "tune": 5, "tupl": 4, "tutori": [5, 8], "two": [2, 7, 8], "txt": [3, 6], "type": [2, 3, 4, 6, 8], "u": [1, 6], "ubuntu": 6, "ultra": 4, "unbalanc": 4, "under": [2, 4, 7], "underscor": 4, "understand": 5, "uniform": 4, "uniqu": 4, "unless": 4, "unpack": 4, "unsaf": 4, "until": 3, "up": [4, 5, 7, 8], "updat": [2, 4, 8], "update_": 4, "upload": 6, "upon": [4, 8], "us": [2, 3, 4, 6, 8], "usag": [4, 5], "use_adaptive_kl_ctl": 4, "use_attention_bia": 4, "use_attn_proj_bia": 4, "use_cuda_graph": 4, "use_sequence_parallel": [4, 8], "user": [2, 3, 4, 5, 8], "usual": 4, "util": [2, 4, 7, 8], "v1": 6, "valid": [4, 8], "valid_bs_n_seq": [4, 8], "valid_path": [4, 8], "valu": [4, 6, 8], "value_eps_clip": [4, 8], "value_norm": [4, 8], "value_norm_beta": 4, "value_norm_ep": 4, "value_norm_typ": 4, "variabl": [2, 3, 6], "variou": 5, "veri": 8, "version": [2, 3, 6], "via": [3, 8], "view": 3, "visit": 8, "vllm": 8, "vocab_s": 4, "vocabulari": 4, "wa": 4, "wai": [6, 7], "wait": 3, "wandb": 4, "wandb_mod": 4, "want": [2, 6, 8], "warm": 4, "warmup_steps_proport": 4, "we": [1, 2, 3, 4, 5, 6, 7, 8], "weight": 4, "weight_decai": 4, "well": [2, 8], "what": [2, 4, 8], "wheel": 6, "when": [2, 3, 4, 7], "where": [2, 3, 4, 7, 8], "whether": [4, 6], "which": [2, 4, 8], "while": [4, 7, 8], "wide": 5, "window": 4, "wish": 1, "within": [4, 8], "without": [2, 3, 4], "work": 4, "worker": [3, 4, 5, 8], "workload": [7, 8], "world": 4, "would": [3, 8], "wrap": 2, "x": 4, "xxx": 3, "yeah": 8, "you": [1, 2, 3, 4, 5, 6, 8], "your": [2, 3, 6, 8], "zero": [4, 8], "zero_stag": 4}, "titles": ["Code Architecture", "Contributing", "Customization", "Setting Up Distributed Experiments", "Configurations", "Welcome to ReaL\u2019s documentation!", "Installation", "Introduction", "Quickstart"], "titleterms": {"": 5, "1": 8, "2": 8, "3": 8, "30min": 8, "4x": 8, "7b": 8, "A": 2, "The": 8, "algorithm": 2, "architectur": 0, "cluster": 3, "code": 0, "comparison": 7, "configur": [2, 4], "content": 5, "contribut": 1, "custom": 2, "data": 4, "dataflow": 4, "dataset": [2, 4], "direct": 8, "distribut": 3, "docker": 6, "document": 5, "dpo": 8, "exampl": 2, "exist": 7, "experi": [3, 4], "fine": 8, "from": 6, "function": 2, "get": 5, "grace": 3, "graph": 4, "how": 2, "huggingfac": 2, "i": 2, "imag": 6, "implement": 2, "instal": [6, 8], "interfac": 4, "introduct": 7, "limit": 7, "llama": 8, "model": [2, 4, 8], "new": 2, "next": 8, "optim": 8, "overview": 2, "pars": 2, "perform": 7, "ppo": [2, 8], "prefer": 8, "pypi": 6, "pyxi": 3, "quickstart": 8, "rai": 3, "real": 5, "resourc": 3, "reward": [2, 8], "rlhf": 8, "rm": 8, "set": 3, "shutdown": 3, "slurm": 3, "sourc": 6, "spec": 3, "stage": 8, "start": 5, "step": [2, 8], "structur": 4, "supervis": 8, "support": 2, "system": 7, "tune": 8, "up": 3, "welcom": 5}})