Search.setIndex({"alltitles": {"Code Architecture": [[0, "code-architecture"]], "Configurations": [[4, "configurations"]], "Contents": [[5, "contents"]], "Contributing": [[1, "contributing"]], "Customization": [[2, "customization"]], "Customizing Algorithms": [[2, "customizing-algorithms"]], "Customizing Datasets": [[2, "customizing-datasets"]], "Customizing Models": [[2, "customizing-models"]], "Dataflow Graph": [[4, "dataflow-graph"]], "Dataset Configurations": [[4, "dataset-configurations"]], "Docker Images": [[6, "docker-images"]], "Example: A Customized Reward Function for PPO": [[2, "example-a-customized-reward-function-for-ppo"]], "Experiment Configurations": [[4, "experiment-configurations"]], "How Dataset Configuration is Parsed": [[2, "how-dataset-configuration-is-parsed"]], "Install From PyPI or Source": [[6, "install-from-pypi-or-source"]], "Installation": [[6, "installation"], [8, "installation"]], "Introduction": [[7, "introduction"]], "Model Configurations": [[4, "model-configurations"]], "NamedArray": [[4, "namedarray"]], "Overview": [[2, "overview"], [2, "id1"], [2, "id2"]], "Quickstart": [[8, "quickstart"]], "RLHF with 4x LLaMA-7B in 30min": [[8, "rlhf-with-4x-llama-7b-in-30min"]], "Set Up Distributed Experiments": [[3, "set-up-distributed-experiments"]], "Stage 1: Supervised Fine-Tuning": [[8, "stage-1-supervised-fine-tuning"]], "Stage 2.1: Reward Modeling (RM)": [[8, "stage-2-1-reward-modeling-rm"]], "Stage 2.2: Direct Preference Optimization (DPO)": [[8, "stage-2-2-direct-preference-optimization-dpo"]], "Stage 3: PPO": [[8, "stage-3-ppo"]], "Steps for Implementing a New Dataset": [[2, "steps-for-implementing-a-new-dataset"]], "Steps to Support a New HuggingFace Model": [[2, "steps-to-support-a-new-huggingface-model"]], "Welcome to ReaL\u2019s documentation!": [[5, "welcome-to-real-s-documentation"]]}, "docnames": ["arch", "contributing", "customization", "distributed", "expconfig", "index", "install", "intro", "quickstart"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["arch.rst", "contributing.rst", "customization.rst", "distributed.rst", "expconfig.rst", "index.rst", "install.rst", "intro.rst", "quickstart.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [2, 8], "0": [2, 3, 6, 8], "00": 8, "007": 8, "01": 3, "03": 8, "04": [3, 6], "051": 8, "081": 8, "083": 8, "094": 8, "1": [2, 3, 5, 6], "10": [6, 8], "1000": [2, 8], "1024": 8, "128": 8, "13": 8, "13b": 7, "14": 8, "15": 8, "19": 8, "2": [5, 7], "20240618": 8, "216": 8, "22": [3, 6], "23": 6, "256": 8, "26": 8, "294": 8, "3": 5, "30min": 5, "312": 8, "32": 8, "34": 8, "34b": 7, "38": 8, "387": 8, "39": 8, "393": 8, "3d": 8, "4": [7, 8], "400": 7, "46": 8, "4x": 5, "5": 8, "50": 8, "5000": 8, "512": 8, "53": 8, "54": 8, "56": 8, "574": 8, "628": 8, "7": [6, 8], "70b": 7, "7b": [5, 7], "8": 8, "9": [2, 8], "906": 8, "A": [3, 5, 8], "As": [2, 8], "At": 2, "By": 7, "For": [2, 3, 8], "If": [1, 2, 6, 8], "In": [2, 7, 8], "It": [4, 8], "On": 6, "The": [2, 3, 6, 7, 8], "There": 2, "These": [2, 8], "To": [2, 3, 6], "With": 8, "__getitem__": 2, "__init__": 2, "__post_init__": 2, "_class": 8, "a100": 3, "about": [1, 8], "abov": [2, 3, 8], "access": 3, "accommod": 8, "accord": 8, "acknowledg": 2, "across": 8, "actor": [2, 7, 8], "actor_train": 8, "actortrain": 8, "actual": 2, "adam": 8, "add": 3, "addit": [2, 3, 8], "address": 7, "adopt": 8, "adv_norm": 8, "after": [6, 8], "again": 4, "aggreg": 4, "aigc": 8, "algorithm": [5, 8], "all": [2, 3, 6], "alloc": 8, "allocation_mod": 8, "allow": [3, 6], "along": 2, "also": [2, 3, 6, 7, 8], "altern": 7, "although": 4, "among": 8, "an": [2, 3, 4, 6, 7, 8], "analysi": 2, "ani": [1, 2, 8], "answer": 8, "api": 2, "app": [2, 3, 8], "appli": [2, 7], "applic": [1, 2, 8], "approxim": 8, "ar": [2, 3, 7, 8], "arbitrari": 3, "architectur": 2, "area": 7, "arg": 2, "argument": [2, 4], "arrai": 4, "art": 7, "assign": [7, 8], "assist": 1, "assum": [3, 8], "asymmetr": 7, "attention_mask": 2, "attribut": 8, "automat": [2, 8], "automodelforsequenceclassif": 2, "autotoken": 2, "avail": 6, "avoid": 8, "back": 2, "backend": 2, "backward": 8, "bar": 7, "base": 7, "bash": 6, "batch": [2, 8], "batch_decod": 2, "becaus": [2, 7], "been": 8, "being": 8, "below": 3, "berlin": 8, "bert": 2, "besid": 8, "best": [1, 8], "between": [2, 7, 8], "block": 2, "both": 8, "break": 2, "build": [6, 8], "built": 6, "c": 6, "call": [2, 4, 7, 8], "can": [1, 2, 4, 6, 7, 8], "capit": 8, "case": 2, "caus": [4, 7, 8], "cd": [6, 8], "cfg": 2, "challeng": 2, "chang": 2, "chat": 7, "check": [2, 4, 6, 8], "checkpoint": [3, 8], "choos": 7, "class": [2, 4], "clone": [6, 8], "cluster": [3, 6], "cluster_config": 3, "cluster_nam": 3, "cluster_spec_path": 3, "cluster_typ": 3, "code": [1, 2, 6], "codellama": 7, "com": [3, 6, 8], "comma": 3, "command": [2, 3, 4, 6, 8], "comment": 8, "common": 8, "commonli": 2, "commun": [1, 7, 8], "comparison": [7, 8], "compil": [2, 6], "complet": [7, 8], "complex": 8, "compos": [7, 8], "comput": [2, 7, 8], "concaten": 2, "conceptu": 2, "concret": 4, "concurr": 7, "config": 2, "config_api": 2, "configur": [3, 5, 8], "consequ": 8, "consid": 2, "consist": 2, "consol": 8, "construct": 2, "constructor": 2, "consum": 8, "consumpt": 8, "contact": 1, "contain": [2, 3, 6], "context": 8, "contigu": 2, "contribut": 5, "control": [3, 8], "conveni": 8, "converg": 8, "convers": 2, "convert": 2, "core": 2, "correspond": [2, 4, 8], "cover": 8, "cpu": [3, 6], "cpu_imag": 3, "creat": [2, 3], "critic": [2, 7, 8], "cuda": [2, 4, 6], "current": [1, 2, 3, 6], "custom": [5, 8], "data": [2, 4, 8], "data_api": 2, "data_parallel_s": 8, "dataclass": [2, 8], "dataflow": [2, 5], "dataset": [5, 8], "dataset_path": 2, "deepspe": [7, 8], "def": 2, "default_mount": 3, "degre": 7, "demonstr": 2, "dep": 6, "depend": [2, 6, 7], "deploi": 8, "deploy": 6, "describ": 2, "design": 8, "destin": 8, "detail": [2, 8], "develop": [6, 8], "dfg": 2, "dict": 2, "dictionari": [3, 4, 8], "differ": [4, 7, 8], "direct": 5, "directli": [1, 6, 8], "distinct": 8, "distribut": [5, 7], "do": [1, 2], "docker": [3, 5], "dockerfil": 6, "document": 2, "doe": [2, 8], "don": [2, 4, 6], "done": 8, "download": 8, "dpo": 5, "due": 8, "dump": 8, "dure": 2, "dynam": 7, "e": [2, 3, 4, 6, 7, 8], "each": [2, 4, 7, 8], "easiest": 6, "edg": 2, "edit": 6, "effect": 7, "effici": [2, 7, 8], "elimin": 7, "embed": 2, "empow": 1, "enabl": [1, 7], "encod": 2, "end": [2, 3], "engin": 8, "enroot": 3, "entir": 7, "entri": 8, "env": 3, "environ": 3, "epoch": 8, "estim": 7, "eval": 2, "eval_freq_epoch": 8, "evalu": 2, "everi": [2, 3, 4, 7], "exactli": 8, "exampl": [3, 4, 5, 8], "except": [2, 4], "execut": [2, 7, 8], "exist": [6, 7], "experi": [2, 5, 6, 8], "experiment_nam": [2, 8], "experimentconfig": 2, "explan": 8, "express": 3, "extend": 4, "extens": 6, "extern": 2, "fals": 8, "familiar": 8, "fast": 8, "faster": 8, "favor": 8, "feasibl": 8, "featur": [2, 4], "feel": 2, "field": [2, 8], "figur": [2, 7], "file": [2, 3, 8], "fileroot": 3, "final": 2, "find": 2, "fine": 5, "finish": 8, "first": [2, 6, 7, 8], "flash_attn": 6, "float": 2, "folder": 2, "follow": [2, 3, 4, 6, 7, 8], "force_no_logits_mask": 8, "forget": 2, "form": 8, "format": 8, "former": 8, "forth": 2, "forward": 8, "found": [2, 8], "four": 8, "framework": 8, "franc": 8, "free": 2, "friendli": 4, "from": [2, 3, 4, 5, 7, 8], "from_hf": 2, "from_llama": 2, "from_pretrain": 2, "frozen": 8, "full": 7, "fulli": 8, "function": [4, 5, 8], "fw": 8, "g": [2, 3, 4, 7, 8], "g1": 3, "g2": 3, "g8": 3, "garrett4wad": [3, 6], "gener": [2, 7, 8], "get": 2, "git": [6, 8], "github": [2, 6, 8], "given": [4, 8], "global": 8, "gpu": [2, 3, 6, 7, 8], "gpu_imag": 3, "gpu_type_from_node_nam": 3, "gradient_checkpoint": 8, "grai": 7, "graph": [2, 5], "ha": [2, 8], "half": 8, "handl": 8, "have": [1, 2, 8], "help": [1, 8], "helper": 2, "hesit": 1, "heurist": 8, "hf": 8, "hope": 1, "host": [3, 4], "hour": 8, "how": 5, "howev": 7, "http": [6, 8], "hub": 2, "huggingfac": [5, 8], "hydra": [4, 8], "hyperparamet": 8, "i": [1, 3, 4, 5, 6, 7, 8], "id": 2, "idea": 7, "identifi": [2, 8], "idx": 2, "illustr": [2, 4, 8], "imag": [3, 5], "imdb": 2, "impl": 2, "implement": 5, "improv": [1, 7, 8], "includ": [2, 3, 8], "increas": 7, "independ": 8, "index": 4, "indic": 2, "individu": 8, "inf_reward_rpc": 2, "infer": [2, 8], "info": 8, "inherit": 4, "initi": [2, 8], "initial_setup": 2, "input": 2, "input_id": 2, "insid": [3, 6], "instal": 5, "instrctgpt": 8, "instruct": [2, 6], "integ": 3, "interfac": 2, "interface_impl": 2, "interface_typ": 2, "introduct": [5, 8], "involv": [2, 8], "io": 6, "is_crit": 8, "isol": [6, 8], "issu": [1, 2], "iter": [2, 7, 8], "its": 2, "json": [3, 8], "jsonl": 8, "kei": [2, 7, 8], "kl": 8, "kl_ctl": [2, 8], "larg": [2, 8], "largest": 7, "latter": 8, "launch": [2, 3, 6, 8], "layer": [2, 3], "lead": 7, "learn": 8, "length": [2, 4], "let": [2, 8], "light": 7, "like": [2, 8], "limit": 7, "line": [2, 4, 8], "list": [3, 8], "llama": [2, 5, 7], "llm": [1, 8], "load": [2, 8], "local": [6, 8], "locat": [2, 8], "log": [3, 8], "logit": 2, "loss": 8, "low": 3, "lustr": 8, "m": [2, 3, 6, 8], "machin": 6, "mai": 8, "main": 8, "major": [7, 8], "make": 8, "manag": [4, 8], "manual": 8, "map": [2, 3], "mask": 4, "master": [3, 8], "masterwork": 2, "match": 3, "max_length": 2, "max_new_token": 8, "max_pairs_per_prompt": 8, "max_prompt_len": 8, "max_seqlen": [2, 8], "maxim": [7, 8], "memori": [2, 8], "mention": 3, "metadata": [2, 4], "method": 2, "mfc": 2, "mfcdef": 2, "micro": 2, "min_new_token": 8, "minut": 8, "mode": 8, "model": [3, 5, 7], "model_api": 2, "model_nam": 2, "model_parallel_s": 8, "model_rpc": 2, "model_work": 2, "modelbackend": 2, "modelinterfac": 2, "modelwork": 2, "modif": 2, "modifi": [2, 6], "moe": 2, "monitor": 2, "more": [2, 8], "moreov": 8, "most": 8, "mount": [3, 6], "move": 8, "movi": 8, "multipl": [4, 8], "mw": 2, "my": [2, 3], "myppoconfig": 2, "n_node": 8, "name": [2, 3, 4], "namedarrai": [2, 5], "necessari": 2, "need": [2, 3], "neg": [2, 8], "neg_answ": 8, "nest": 4, "new": 5, "next": [6, 8], "nf": 3, "nn": 2, "no_grad": 2, "node": [2, 3, 6, 7, 8], "node_name_prefix": 3, "node_type_from_node_nam": 3, "none": 8, "note": [2, 8], "now": 2, "null": [2, 8], "number": [7, 8], "nvcr": 6, "nvidia": 6, "object": [2, 4, 8], "observ": 7, "offer": 6, "offload": [2, 8], "often": [2, 7], "onc": [2, 8], "one": [2, 3], "onli": [3, 6], "onlin": 2, "open": [1, 7], "openpsi": [6, 8], "openrlhf": 7, "optim": 5, "option": [2, 4, 8], "ordinari": 8, "origin": 2, "other": 2, "our": [1, 2, 7, 8], "output": [2, 8], "outsid": 6, "over": [7, 8], "overhead": [7, 8], "overrid": 4, "overview": 5, "overwritten": 8, "packag": 6, "pad": [2, 4], "page": 4, "pair": 8, "pairedcomparisondatasetconfig": 2, "pairwis": 8, "paper": 8, "parallel": [7, 8], "paramet": [2, 7, 8], "pars": 5, "pass": [2, 8], "path": [2, 3, 6, 8], "perform": [2, 8], "pip": 6, "pip3": 8, "pipe": 8, "pipelin": [2, 7, 8], "pipeline_parallel_s": 8, "plain": 4, "plan": 8, "pleas": [1, 2, 4, 8], "plugin": 3, "point": 2, "polici": 8, "pos_answ": 8, "posit": [2, 8], "possibli": 4, "post_hook": 2, "ppo": [3, 4, 5], "ppo_n_minibatch": 8, "ppo_prompt": 8, "ppo_senti": 2, "ppoconfig": 2, "ppohyperparamet": 8, "practic": 8, "pre": [6, 8], "prefer": [5, 6], "prefix": 3, "prepar": 8, "previou": [4, 7], "primari": 8, "primarili": 2, "prior": 7, "probabl": 8, "proce": 8, "procedur": 8, "process": [7, 8], "profil": 7, "project": [4, 6, 8], "prompt": 8, "prompt_answ": 2, "prompt_answer_dataset": 2, "promptanswerdataset": 2, "promptanswerdatasetconfig": 2, "promptonlydatasetconfig": 2, "properli": 8, "properti": 2, "provid": [2, 4, 6, 8], "pt": 2, "pull": [1, 6], "purpl": 7, "py": 2, "py3": 6, "pypi": 5, "python": 8, "python3": [2, 3, 6, 8], "pytorch": [2, 6], "pyxi": 3, "question": [1, 2], "quickstart": [2, 3, 4, 5, 6], "r": 6, "rais": [1, 2], "rate": 8, "re": [2, 8], "real": [2, 3, 4, 6, 7, 8], "real_llm_api": 2, "realhf": [2, 3, 4, 6, 8], "realloc": [2, 7], "realmodel": 2, "realmodelconfig": 2, "reason": 2, "record": 2, "recurs": [4, 8], "reduc": 8, "redund": 7, "ref": 8, "ref_inf": 8, "refer": [2, 3, 8], "refinf": 8, "regard": 4, "regist": 2, "register_dataset": 2, "register_hf_famili": 2, "register_interfac": 2, "register_metadata": 2, "register_quickstart_exp": 2, "regular": [3, 8], "rel": 8, "releas": 8, "remap": [2, 8], "rememb": 6, "remind": 8, "remov": 2, "replac": 2, "repositori": [1, 2, 6, 8], "repres": [2, 8], "request": [1, 2], "requir": [2, 6, 8], "rerun": 6, "reserv": 2, "respect": [2, 8], "respons": 8, "result": [2, 4], "return": 2, "return_tensor": 2, "rew": [2, 8], "reward": 5, "reward_output_sc": 8, "rlhf": [1, 5, 7], "rm": 5, "rm_pair": 8, "role": 2, "rpc": 2, "run": [2, 6, 8], "runtim": 6, "rw": 8, "same": [7, 8], "sampl": [2, 8], "satisfi": 2, "save": [2, 8], "save_freq_step": 8, "scale": 7, "scenario": 2, "score": 2, "score_model": 2, "score_token": 2, "script": 2, "search": 8, "second": 7, "see": [2, 8], "self": 2, "sentiment": [2, 8], "sentiment_scor": 2, "sentimentscoringinterfac": 2, "separ": 3, "sequenc": [2, 4], "set": [5, 8], "sft": [2, 4, 8], "sft_interfac": 2, "sft_po": 8, "sftconfig": [2, 4, 8], "sftinterfac": 2, "shape": 4, "shard": [2, 8], "share": 2, "should": [2, 3, 4, 6, 8], "show": [7, 8], "shown": [3, 7], "signal": 2, "signatur": 2, "similar": 2, "sinc": 4, "singl": [2, 8], "six": 8, "size": [7, 8], "skip_special_token": 2, "slice": 4, "slurm": 3, "smaller": 7, "so": [2, 6, 8], "solut": 7, "some": 2, "sourc": [1, 5, 7, 8], "specif": [2, 4, 8], "specifi": [2, 3, 8], "srl": 4, "srun": 3, "stage": 5, "state": [2, 7], "step": [5, 7, 8], "stop": 8, "store": [2, 3, 4], "strategi": [7, 8], "string": [3, 8], "structur": 8, "style": 2, "substanti": [7, 8], "successfulli": 8, "sum": 8, "super": 2, "supervis": 5, "support": [3, 5, 8], "synchron": [4, 7], "system": [2, 4, 7], "system_api": 2, "t": [2, 4, 6], "tailor": 7, "take": 8, "task": 7, "techniqu": 8, "technologi": 1, "templat": 1, "tensor": [4, 7, 8], "test": 2, "text": 2, "than": 8, "therefor": 8, "thi": [1, 2, 3, 4, 6, 8], "three": [2, 8], "throughput": 7, "time": [7, 8], "timelin": 7, "tmp": 3, "to_llama": 2, "token": 2, "tokenizer_path": 2, "top_k": [2, 8], "top_p": [2, 8], "torch": 2, "total": 8, "total_train_epoch": 8, "train": [2, 7, 8], "train_bs_n_seq": 8, "train_path": [2, 8], "transform": 2, "transformerengin": 6, "travel": 8, "trial_nam": [2, 8], "true": [2, 8], "truli": 1, "truncat": 2, "tune": 5, "tutori": 8, "two": [2, 7, 8], "txt": 6, "type": [2, 3, 4, 8], "u": 1, "ubuntu": 6, "under": [2, 7], "unfamiliar": 2, "up": [5, 7, 8], "updat": [2, 8], "upload": 6, "upon": 8, "us": [2, 3, 4, 6, 8], "use_sequence_parallel": 8, "user": [2, 4, 8], "util": [2, 7, 8], "v1": 6, "valid": 8, "valid_bs_n_seq": 8, "valid_path": 8, "valu": 8, "value_eps_clip": 8, "value_norm": 8, "variabl": [2, 3], "veri": 8, "version": [2, 6], "via": 8, "visit": 8, "vllm": 8, "wai": [4, 6, 7], "want": [2, 6], "we": [1, 2, 3, 4, 6, 7, 8], "well": [2, 8], "what": [2, 8], "wheel": 6, "when": [2, 3, 7], "where": [2, 3, 7, 8], "which": [2, 4, 8], "while": [7, 8], "wish": [1, 2], "within": 8, "without": [2, 4], "worker": [3, 8], "workload": [7, 8], "wrap": 2, "yeah": 8, "you": [1, 2, 3, 6, 8], "your": [2, 6, 8], "zero": 8}, "titles": ["Code Architecture", "Contributing", "Customization", "Set Up Distributed Experiments", "Configurations", "Welcome to ReaL\u2019s documentation!", "Installation", "Introduction", "Quickstart"], "titleterms": {"": 5, "1": 8, "2": 8, "3": 8, "30min": 8, "4x": 8, "7b": 8, "A": 2, "algorithm": 2, "architectur": 0, "code": 0, "configur": [2, 4], "content": 5, "contribut": 1, "custom": 2, "dataflow": 4, "dataset": [2, 4], "direct": 8, "distribut": 3, "docker": 6, "document": 5, "dpo": 8, "exampl": 2, "experi": [3, 4], "fine": 8, "from": 6, "function": 2, "graph": 4, "how": 2, "huggingfac": 2, "i": 2, "imag": 6, "implement": 2, "instal": [6, 8], "introduct": 7, "llama": 8, "model": [2, 4, 8], "namedarrai": 4, "new": 2, "optim": 8, "overview": 2, "pars": 2, "ppo": [2, 8], "prefer": 8, "pypi": 6, "quickstart": 8, "real": 5, "reward": [2, 8], "rlhf": 8, "rm": 8, "set": 3, "sourc": 6, "stage": 8, "step": 2, "supervis": 8, "support": 2, "tune": 8, "up": 3, "welcom": 5}})