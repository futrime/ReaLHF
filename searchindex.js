Search.setIndex({"alltitles": {"Code Architecture": [[0, "code-architecture"]], "Configurations": [[4, "configurations"]], "Contents": [[5, "contents"]], "Contributing": [[1, "contributing"]], "Customization": [[2, "customization"]], "Customizing Algorithms": [[2, "customizing-algorithms"]], "Customizing Datasets": [[2, "customizing-datasets"]], "Customizing Models": [[2, "customizing-models"]], "Dataflow Graph": [[4, "dataflow-graph"]], "Dataset Configurations": [[4, "dataset-configurations"]], "Docker Images": [[6, "docker-images"]], "Example: A Customized Reward Function for PPO": [[2, "example-a-customized-reward-function-for-ppo"]], "Experiment Configurations": [[4, "experiment-configurations"]], "How Dataset Configuration is Parsed": [[2, "how-dataset-configuration-is-parsed"]], "Install From PyPI or Source": [[6, "install-from-pypi-or-source"]], "Installation": [[6, "installation"], [8, "installation"]], "Introduction": [[7, "introduction"]], "Model Configurations": [[4, "model-configurations"]], "NamedArray": [[4, "namedarray"]], "Overview": [[2, "overview"], [2, "id1"], [2, "id2"]], "Quickstart": [[8, "quickstart"]], "RLHF with 4x LLaMA-7B in 30min": [[8, "rlhf-with-4x-llama-7b-in-30min"]], "Set Up Distributed Experiments": [[3, "set-up-distributed-experiments"]], "Stage 1: Supervised Fine-Tuning": [[8, "stage-1-supervised-fine-tuning"]], "Stage 2.1: Reward Modeling (RM)": [[8, "stage-2-1-reward-modeling-rm"]], "Stage 2.2: Direct Preference Optimization (DPO)": [[8, "stage-2-2-direct-preference-optimization-dpo"]], "Stage 3: PPO": [[8, "stage-3-ppo"]], "Steps for Implementing a New Dataset": [[2, "steps-for-implementing-a-new-dataset"]], "Steps to Support a New HuggingFace Model": [[2, "steps-to-support-a-new-huggingface-model"]], "Welcome to ReaL\u2019s documentation!": [[5, "welcome-to-real-s-documentation"]]}, "docnames": ["arch", "contributing", "customization", "distributed", "expconfig", "index", "install", "intro", "quickstart"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2}, "filenames": ["arch.rst", "contributing.rst", "customization.rst", "distributed.rst", "expconfig.rst", "index.rst", "install.rst", "intro.rst", "quickstart.rst"], "indexentries": {"allocationconfig (class in realhf)": [[4, "realhf.AllocationConfig", false]], "async_offload() (realhf.impl.model.nn.real_llm_api.realmodel method)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel.async_offload", false]], "clear_metadata() (realhf.base.namedarray.namedarray method)": [[4, "realhf.base.namedarray.NamedArray.clear_metadata", false]], "commonexperimentconfig (class in realhf)": [[4, "realhf.CommonExperimentConfig", false]], "dpoconfig (class in realhf)": [[4, "realhf.DPOConfig", false]], "evaluate() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.evaluate", false]], "generate() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.generate", false]], "inference() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.inference", false]], "instantiate() (realhf.impl.model.nn.real_llm_api.realmodel method)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel.instantiate", false]], "is_critic (realhf.impl.model.nn.real_llm_api.realmodel property)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel.is_critic", false]], "items() (realhf.base.namedarray.namedarray method)": [[4, "realhf.base.namedarray.NamedArray.items", false]], "metadata (realhf.base.namedarray.namedarray property)": [[4, "realhf.base.namedarray.NamedArray.metadata", false]], "mfcdef (class in realhf)": [[4, "realhf.MFCDef", false]], "modelinterface (class in realhf)": [[2, "realhf.ModelInterface", false]], "modeltrainevalconfig (class in realhf)": [[4, "realhf.ModelTrainEvalConfig", false]], "namedarray (class in realhf.base.namedarray)": [[4, "realhf.base.namedarray.NamedArray", false]], "num_layers (realhf.impl.model.nn.real_llm_api.realmodel property)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel.num_layers", false]], "optimizerconfig (class in realhf)": [[4, "realhf.OptimizerConfig", false]], "pairedcomparisondatasetconfig (class in realhf)": [[4, "realhf.PairedComparisonDatasetConfig", false]], "parallelismconfig (class in realhf)": [[4, "realhf.ParallelismConfig", false]], "pop_metadata() (realhf.base.namedarray.namedarray method)": [[4, "realhf.base.namedarray.NamedArray.pop_metadata", false]], "ppoconfig (class in realhf)": [[4, "realhf.PPOConfig", false]], "ppohyperparameters (class in realhf)": [[4, "realhf.PPOHyperparameters", false]], "promptanswerdatasetconfig (class in realhf)": [[4, "realhf.PromptAnswerDatasetConfig", false]], "promptonlydatasetconfig (class in realhf)": [[4, "realhf.PromptOnlyDatasetConfig", false]], "realmodel (class in realhf.impl.model.nn.real_llm_api)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel", false]], "realmodelconfig (class in realhf)": [[4, "realhf.ReaLModelConfig", false]], "register_metadata() (realhf.base.namedarray.namedarray method)": [[4, "realhf.base.namedarray.NamedArray.register_metadata", false]], "rwconfig (class in realhf)": [[4, "realhf.RWConfig", false]], "save() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.save", false]], "sftconfig (class in realhf)": [[4, "realhf.SFTConfig", false]], "train_step() (realhf.modelinterface method)": [[2, "realhf.ModelInterface.train_step", false]], "wait_for_offload() (realhf.impl.model.nn.real_llm_api.realmodel method)": [[4, "realhf.impl.model.nn.real_llm_api.ReaLModel.wait_for_offload", false]]}, "objects": {"realhf": [[4, 0, 1, "", "AllocationConfig"], [4, 0, 1, "", "CommonExperimentConfig"], [4, 0, 1, "", "DPOConfig"], [4, 0, 1, "", "MFCDef"], [2, 0, 1, "", "ModelInterface"], [4, 0, 1, "", "ModelTrainEvalConfig"], [4, 0, 1, "", "OptimizerConfig"], [4, 0, 1, "", "PPOConfig"], [4, 0, 1, "", "PPOHyperparameters"], [4, 0, 1, "", "PairedComparisonDatasetConfig"], [4, 0, 1, "", "ParallelismConfig"], [4, 0, 1, "", "PromptAnswerDatasetConfig"], [4, 0, 1, "", "PromptOnlyDatasetConfig"], [4, 0, 1, "", "RWConfig"], [4, 0, 1, "", "ReaLModelConfig"], [4, 0, 1, "", "SFTConfig"]], "realhf.ModelInterface": [[2, 1, 1, "", "evaluate"], [2, 1, 1, "", "generate"], [2, 1, 1, "", "inference"], [2, 1, 1, "", "save"], [2, 1, 1, "", "train_step"]], "realhf.base.namedarray": [[4, 0, 1, "", "NamedArray"]], "realhf.base.namedarray.NamedArray": [[4, 1, 1, "", "clear_metadata"], [4, 1, 1, "", "items"], [4, 2, 1, "", "metadata"], [4, 1, 1, "", "pop_metadata"], [4, 1, 1, "", "register_metadata"]], "realhf.impl.model.nn.real_llm_api": [[4, 0, 1, "", "ReaLModel"]], "realhf.impl.model.nn.real_llm_api.ReaLModel": [[4, 1, 1, "", "async_offload"], [4, 1, 1, "", "instantiate"], [4, 2, 1, "", "is_critic"], [4, 2, 1, "", "num_layers"], [4, 1, 1, "", "wait_for_offload"]]}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property"}, "terms": {"": [2, 4, 8], "0": [2, 3, 4, 6, 8], "00": 8, "007": 8, "01": [3, 4], "02": 4, "03": 8, "04": [3, 6], "05": 4, "051": 8, "081": 8, "083": 8, "094": 8, "1": [2, 3, 4, 5, 6], "10": [6, 8], "1000": [2, 8], "10000": 4, "1024": [4, 8], "128": 8, "13": 8, "13b": 7, "14": 8, "15": 8, "19": 8, "1d": 4, "1e": 4, "2": [4, 5, 6, 7], "20": 4, "20240618": 8, "216": 8, "22": [3, 6], "23": 6, "256": [4, 8], "26": 8, "294": 8, "3": [4, 5], "30min": 5, "312": 8, "32": 8, "34": 8, "34b": 7, "38": 8, "387": 8, "39": 8, "393": 8, "3d": [4, 8], "4": [4, 6, 7, 8], "400": 7, "42": 4, "46": 8, "4x": 5, "5": [4, 8], "50": [4, 8], "5000": 8, "512": 8, "53": 8, "54": 8, "56": 8, "574": 8, "628": 8, "7": [4, 8], "70b": 7, "7b": [4, 5, 7], "8": [4, 6, 8], "9": [2, 4, 8], "906": 8, "95": 4, "99995": 4, "A": [3, 4, 5, 8], "As": [2, 4, 8], "At": 2, "By": 7, "For": [2, 3, 4, 8], "If": [1, 2, 4, 6, 8], "In": [2, 4, 7, 8], "It": [4, 8], "No": 6, "On": 6, "One": 4, "The": [2, 3, 4, 6, 7, 8], "There": 2, "These": [2, 8], "To": [2, 3, 6], "With": 8, "__getitem__": [2, 4], "__init__": [2, 4], "__post_init__": 2, "_class": 8, "a100": 3, "about": [1, 8], "abov": [2, 3, 8], "abs_position_embedding_offset": 4, "absolut": 4, "access": 3, "accommod": 8, "accord": [4, 8], "accumul": 4, "accur": 4, "acknowledg": 2, "across": 8, "act": 4, "action": 4, "activ": 4, "activation_funct": 4, "actor": [2, 4, 7, 8], "actor_gen": 4, "actor_train": [4, 8], "actortrain": 8, "actual": [2, 4], "adam": [4, 8], "adapt": 4, "add": 3, "addit": [2, 3, 4, 8], "address": 7, "adopt": 8, "adv_norm": [4, 8], "advanc": 4, "advantag": 4, "after": [4, 6, 8], "again": 4, "aggreg": 4, "aigc": 8, "algorithm": [4, 5, 8], "align": 4, "all": [2, 3, 4, 6], "alloc": [4, 8], "allocation_mod": [4, 8], "allocation_use_cach": 4, "allocationconfig": [4, 5], "allow": [3, 6], "along": 2, "also": [2, 3, 4, 6, 7, 8], "altern": 7, "although": 4, "among": 8, "amount": 4, "an": [2, 3, 4, 6, 7, 8], "analysi": 2, "ani": [1, 2, 4, 8], "anneal": 4, "answer": [4, 8], "api": [2, 4], "app": [2, 3, 4, 8], "append": 4, "appli": [2, 4, 7], "applic": [1, 2, 8], "apply_rotari": 4, "approxim": 8, "ar": [2, 3, 4, 7, 8], "arbitrari": 3, "architectur": 2, "area": 7, "arg": 2, "argument": [2, 4], "arrai": 4, "art": 7, "assert": 4, "assign": [7, 8], "assist": 1, "assum": [3, 8], "asymmetr": 7, "async_offload": 4, "asynchron": 4, "attent": 4, "attention_mask": 2, "attn": 4, "attn_pdrop": 4, "attribut": 8, "auto": 4, "automat": [2, 4, 8], "automodelforsequenceclassif": 2, "autotoken": 2, "avail": [4, 6], "averag": 4, "avoid": 8, "back": 2, "backend": [2, 4], "backward": 8, "balanc": 4, "balanced_dp": 4, "bar": 7, "base": [4, 7], "bash": 6, "batch": [2, 4, 8], "batch_decod": 2, "becaus": [2, 4, 7], "been": 8, "befor": 4, "behavior": 4, "being": 8, "below": 3, "benefit": 4, "berlin": 8, "bert": 2, "besid": 8, "best": [1, 8], "beta": 4, "beta1": 4, "beta2": 4, "between": [2, 7, 8], "bf16": 4, "bia": 4, "block": [2, 4], "bool": 4, "both": [4, 8], "break": 2, "build": 6, "build_graph": 4, "built": 6, "c": 6, "cach": 4, "call": [2, 4, 7, 8], "can": [1, 2, 4, 6, 7, 8], "capit": 8, "case": [2, 4], "caus": [4, 7, 8], "cd": 6, "cfg": 2, "challeng": 2, "chang": [2, 4], "chat": 7, "check": [2, 4, 6, 8], "checkpoint": [3, 4, 8], "children": 4, "children_rpc": 4, "choos": 7, "class": [2, 4], "clear": 4, "clear_metadata": 4, "cli": 4, "clip": 4, "clone": [6, 8], "cluster": [3, 4, 6], "cluster_config": 3, "cluster_nam": 3, "cluster_spec_path": 3, "cluster_typ": 3, "code": [1, 2, 6], "codellama": 7, "coeffici": 4, "com": [3, 6], "combin": 4, "come": 4, "comma": 3, "command": [2, 3, 4, 6, 8], "comment": 8, "common": [4, 8], "commonexperimentconfig": [4, 5], "commonli": 2, "commun": [1, 7, 8], "comparison": [4, 7, 8], "compil": [2, 6], "complet": [7, 8], "complex": 8, "compos": [4, 7, 8], "comput": [2, 7, 8], "concaten": 2, "conceptu": 2, "concret": 4, "concurr": [4, 7], "config": [2, 4], "config_api": 2, "configur": [3, 5, 8], "connect": 4, "consequ": 8, "consid": 2, "consist": 2, "consol": 8, "constant": 4, "construct": [2, 4], "constructor": 2, "consum": 8, "consumpt": 8, "contact": 1, "contain": [2, 3, 4, 6], "context": [4, 8], "contigu": [2, 4], "contribut": 5, "control": [3, 4, 6, 8], "conveni": 8, "converg": 8, "convers": 2, "convert": [2, 4], "core": [2, 4], "correspond": [2, 4, 8], "cosin": 4, "cover": 8, "cpu": [3, 4, 6], "cpu_imag": 3, "creat": [2, 3], "critic": [2, 4, 7, 8], "critic_inf": 4, "critic_train": 4, "cuda": [2, 4, 6], "current": [1, 2, 3, 4, 6], "custom": [4, 5, 8], "data": [2, 4, 8], "data2required_rpc_nam": 4, "data_api": 2, "data_parallel_s": [4, 8], "data_produc": 4, "dataclass": [2, 8], "dataflow": [2, 5], "dataload": 2, "dataset": [5, 8], "dataset_path": 2, "debug": 4, "decai": 4, "decid": 4, "deepspe": [4, 7, 8], "def": [2, 4], "default": 4, "default_mount": 3, "defin": 4, "degre": [4, 7], "demonstr": 2, "denomin": 4, "denorm": 4, "dep": 6, "depend": [2, 4, 6, 7], "deploi": 8, "deploy": 6, "describ": 2, "design": 8, "destin": 8, "detail": [2, 8], "dev": 4, "develop": [4, 6, 8], "devic": 4, "device_mesh": 4, "dfg": [2, 4], "dict": [2, 4], "dictionari": [3, 4, 8], "differ": [4, 7, 8], "dimens": 4, "dir": 4, "direct": [4, 5], "directli": [1, 6, 8], "directori": [4, 8], "disabl": 4, "discount": 4, "distinct": [4, 8], "distribut": [5, 7], "diverg": 4, "divers": 4, "do": [1, 2, 4], "do_layernorm_befor": 4, "docker": [3, 4, 5], "dockerfil": 6, "document": 2, "doe": [2, 4, 8], "don": [2, 4, 6], "done": 8, "download": 8, "dpo": [4, 5], "dpoconfig": [4, 5], "drop": 4, "dropout": 4, "dtype": 4, "due": 8, "dump": 8, "dure": [2, 4], "dynam": 7, "e": [2, 3, 4, 6, 7, 8], "each": [2, 4, 7, 8], "earli": 4, "early_stop_imp_ratio": 4, "easiest": 6, "edg": 2, "edit": 6, "effect": [4, 7], "effici": [2, 4, 7, 8], "either": 4, "elimin": 7, "embd_pdrop": 4, "embed": [2, 4], "empow": 1, "empti": 4, "enabl": [1, 4, 7], "enable_bf16": 4, "enable_fp16": 4, "encod": 2, "end": [2, 3], "engin": [4, 8], "enroot": 3, "entir": 7, "entri": [4, 8], "env": 3, "environ": [3, 6], "ep": 4, "epoch": [4, 8], "eps_clip": 4, "epsilon": 4, "error": 4, "estim": [4, 7], "etc": 4, "eval": 2, "eval_dataload": 2, "eval_freq_epoch": [4, 8], "evalu": [2, 4], "even": 4, "everi": [2, 3, 4, 7], "exactli": 8, "exampl": [3, 4, 5, 8], "exce": 4, "except": [2, 4], "exclus": 4, "execut": [2, 4, 7, 8], "exist": [6, 7], "exp": 4, "experi": [2, 5, 6, 8], "experiment_nam": [2, 4, 8], "experimentconfig": 2, "explan": 8, "exponenti": 4, "expos": 4, "express": 3, "extend": 4, "extens": 6, "extent": 6, "extern": 2, "factor": 4, "factori": 4, "fail": 4, "fals": [4, 8], "famili": 4, "familiar": 8, "fast": 8, "faster": [4, 8], "favor": 8, "feasibl": 8, "featur": [2, 4], "feel": 2, "field": [2, 8], "field_nam": 4, "figur": [2, 7], "file": [2, 3, 4, 8], "fileroot": 3, "filter": 4, "final": 2, "find": [2, 4], "fine": 5, "finish": [4, 8], "first": [2, 4, 6, 7, 8], "flash": 4, "flash_attn": 6, "float": [2, 4], "folder": 2, "follow": [2, 3, 4, 6, 7, 8], "foo": 4, "forc": 4, "force_no_logits_mask": [4, 8], "forget": 2, "form": [4, 8], "format": 8, "former": 8, "forth": 2, "forward": [4, 8], "found": [2, 8], "four": [4, 8], "fp16": 4, "framework": 8, "franc": 8, "free": [2, 4], "friendli": 4, "from": [2, 3, 4, 5, 7, 8], "from_hf": 2, "from_llama": 2, "from_pretrain": 2, "frozen": 8, "full": 7, "fulli": 8, "function": [4, 5, 8], "fuse": 4, "fw": 8, "g": [2, 3, 4, 7, 8], "g1": 3, "g2": 3, "g8": 3, "gae": 4, "gae_lambda": 4, "garrett4wad": [3, 6], "gelu": 4, "gemma": 4, "gen": 4, "gener": [2, 4, 7, 8], "generationhyperparamet": 4, "get": [2, 4], "git": 6, "github": [2, 6, 8], "given": [4, 8], "global": 8, "good": 4, "gpt": 4, "gpu": [2, 3, 4, 6, 7, 8], "gpu_imag": 3, "gpu_type_from_node_nam": 3, "gradient": 4, "gradient_accumulation_fus": 4, "gradient_checkpoint": [4, 8], "grai": 7, "graph": [2, 5], "ha": [2, 8], "half": 8, "handl": 8, "have": [1, 2, 4, 8], "head": 4, "head_dim": 4, "help": [1, 4, 8], "helper": 2, "henc": 4, "hesit": 1, "heurist": [4, 8], "hf": 8, "hidden": 4, "hidden_dim": 4, "hold": 4, "hood": 4, "hook": 4, "hope": 1, "host": [3, 4], "hostfil": 4, "hour": 8, "how": 5, "howev": [4, 7], "http": 6, "hub": 2, "huggingfac": [4, 5, 8], "hydra": [4, 8], "hyperparamet": [4, 8], "i": [1, 3, 4, 5, 6, 7, 8], "id": 2, "idea": 7, "identifi": [2, 4, 8], "idx": 2, "ignor": 4, "ignore_worker_error": 4, "illustr": [2, 4, 8], "imag": [3, 4, 5], "image_nam": 4, "imdb": 2, "immedi": 4, "impl": [2, 4], "implement": [4, 5], "impli": 4, "import": 4, "improv": [1, 4, 7, 8], "includ": [2, 3, 8], "increas": [4, 7], "independ": [4, 8], "index": 4, "indic": 2, "individu": 8, "inf_reward_rpc": 2, "infer": [2, 4, 8], "info": 8, "infref": 4, "infreward": 4, "infvalu": 4, "inherit": 4, "init_critic_from_actor": 4, "initi": [2, 4, 8], "initial_setup": 2, "input": [2, 4], "input_data": 4, "input_id": 2, "input_key_remap": 4, "insid": [3, 6], "instal": 5, "instanti": 4, "instead": 4, "instrctgpt": 8, "instruct": [2, 6, 8], "int": 4, "integ": [3, 4], "interest": 4, "interfac": [2, 4], "interface_impl": [2, 4], "interface_typ": [2, 4], "interleav": 4, "intermedi": 4, "intermediate_dim": 4, "interv": 4, "introduct": [5, 8], "invers": 4, "involv": [2, 8], "io": 6, "is_crit": [4, 8], "is_rew_lora": 4, "is_rw_lora": 4, "is_sft_lora": 4, "isol": 6, "issu": [1, 2], "item": 4, "iter": [2, 4, 7, 8], "its": [2, 4], "json": [3, 4, 8], "jsonl": [4, 8], "k": 4, "kei": [2, 4, 7, 8], "kl": [4, 8], "kl_ctl": [2, 4, 8], "known": 4, "kwarg": 4, "lambda": 4, "larg": [2, 4, 8], "largest": 7, "last": 4, "latter": 8, "launch": [2, 3, 4, 6, 8], "layer": [2, 3, 4], "layer_norm_epsilon": 4, "layer_norm_typ": 4, "lead": 7, "learn": [4, 8], "length": [2, 4], "let": [2, 4, 8], "light": 7, "like": [2, 4, 8], "limit": 7, "line": [2, 4, 8], "linear": 4, "list": [3, 4, 8], "llama": [2, 4, 5, 7], "llm": [1, 4, 8], "lm": 4, "load": [2, 4, 8], "local": [4, 6, 8], "locat": [2, 8], "log": [3, 4, 8], "log_return_valu": 4, "logit": [2, 4], "longer": 4, "lora": 4, "loraconfig": 4, "loss": 8, "low": 3, "lr": 4, "lr_scheduler_typ": 4, "lustr": 8, "m": [2, 3, 4, 8], "ma": 4, "machin": [6, 8], "mai": [4, 8], "main": 8, "major": [7, 8], "make": 8, "manag": [4, 8], "manual": [4, 8], "map": [2, 3], "mappingproxytyp": 4, "mark": 4, "mask": 4, "master": [3, 8], "masterwork": 2, "match": 3, "max_concurrent_cal": 4, "max_job": 6, "max_length": 2, "max_min_flow_seq": 4, "max_n_seq": 4, "max_new_token": 8, "max_pairs_per_prompt": [4, 8], "max_prompt_len": [4, 8], "max_reward_clip": 4, "max_seqlen": [2, 4, 8], "maxim": [7, 8], "maximum": 4, "mean": 4, "megatron": 4, "member": 4, "memori": [2, 4, 8], "mention": 3, "mesh": 4, "metadata": [2, 4], "method": [2, 4], "mfc": [2, 4], "mfcdef": [2, 4, 5], "micro": 2, "min_lr_ratio": 4, "min_n_seq": 4, "min_n_seqs_per_dp": 4, "min_new_token": 8, "minibatch": 4, "minimum": 4, "minut": 8, "mlp": 4, "mlp_type": 4, "mode": [4, 8], "model": [3, 5, 7], "model_api": [2, 4], "model_nam": [2, 4], "model_parallel_s": [4, 8], "model_path": 4, "model_rpc": 2, "model_typ": 4, "model_work": 2, "modelbackend": 2, "modelfamili": 4, "modelinterfac": [2, 4], "modelinterfacetyp": 4, "modelnam": 4, "modeltrainevalconfig": [4, 5], "modelwork": 2, "modif": 2, "modifi": [2, 6], "moe": 2, "monitor": 2, "more": [2, 4, 8], "moreov": 8, "most": 8, "mount": [3, 6], "move": [4, 8], "movi": 8, "mpi": 4, "multipl": [4, 8], "must": 4, "mutual": 4, "mw": 2, "my": [2, 3], "my_trial": 4, "myppoconfig": 2, "n_gpus_per_nod": 4, "n_kv_head": 4, "n_layer": 4, "n_node": [4, 8], "n_posit": 4, "n_q_head": 4, "name": [2, 3, 4], "namedarrai": [2, 5], "narrow": 4, "ndarrai": 4, "necessari": 2, "need": [2, 3, 4], "neg": [2, 4, 8], "neg_answ": [4, 8], "nest": 4, "new": [4, 5], "next": [6, 8], "nf": 3, "nn": [2, 4], "no_grad": 2, "node": [2, 3, 4, 6, 7, 8], "node01": 4, "node02": 4, "node_name_prefix": 3, "node_type_from_node_nam": 3, "nodelist": 4, "non": 4, "none": [4, 8], "normal": 4, "normalize_emb": 4, "note": [2, 4, 8], "noth": 4, "now": [2, 4], "np": 4, "null": [2, 8], "num_lay": 4, "number": [4, 7, 8], "numpi": 4, "nvcr": 6, "nvidia": 6, "object": [2, 4, 8], "observ": 7, "occupi": 4, "occur": 4, "offer": 6, "offloa": 4, "offload": [2, 4, 8], "offloadhook": 4, "offset": 4, "often": [2, 7], "omit": 4, "onc": [2, 8], "one": [2, 3, 4], "onli": [3, 4, 6], "onlin": 2, "open": [1, 7], "openpsi": 6, "openrlhf": 7, "opt": 4, "optim": [4, 5], "optimizerconfig": [4, 5], "option": [2, 4, 8], "order": 4, "ordinari": 8, "origin": 2, "other": 2, "our": [1, 2, 7, 8], "out": 4, "output": [2, 4, 8], "output_data": 4, "output_key_remap": 4, "outsid": 6, "over": [4, 7, 8], "overhead": [7, 8], "overrid": 4, "overview": 5, "overwritten": 8, "p": 4, "p1a1": 4, "p1a2": 4, "p2a1": 4, "p2a2": 4, "pack": 4, "packag": 6, "pad": [2, 4], "pad_to_max_length": 4, "page": 4, "pair": [4, 8], "pairedcomparisondatasetconfig": [2, 4, 5], "pairwis": [4, 8], "paper": 8, "parallel": [4, 7, 8], "parallelismconfig": [4, 5], "paramet": [2, 4, 7, 8], "parent": 4, "parent_rpc": 4, "pars": 5, "partit": 4, "pass": [2, 8], "path": [2, 3, 4, 6, 8], "penalti": 4, "per": 4, "perform": [2, 4, 8], "piec": 4, "pip": 6, "pipe": [4, 8], "pipe_data": 4, "pipe_model": 4, "pipelin": [2, 4, 7, 8], "pipeline_parallel_s": [4, 8], "plain": 4, "plan": [4, 8], "pleas": [1, 2, 4, 8], "plugin": 3, "point": [2, 4], "polici": 8, "pop_metadata": 4, "pos_answ": [4, 8], "posit": [2, 4, 8], "possibli": 4, "post_hook": [2, 4], "ppo": [3, 4, 5], "ppo_exp": 4, "ppo_n_minibatch": [4, 8], "ppo_prompt": 8, "ppo_senti": 2, "ppoconfig": [2, 4, 5], "ppohyperparamet": [4, 5, 8], "practic": [4, 8], "pre": [6, 8], "pre_hook": 4, "predict": 4, "prefer": [4, 5, 6], "prefix": 3, "prepar": 8, "previou": [4, 7], "price": 4, "primari": [4, 8], "primarili": 2, "print": 4, "prior": 7, "probabili": 4, "probabl": [4, 8], "problem": 4, "proce": 8, "procedur": 8, "process": [4, 7, 8], "produc": 4, "profil": [4, 7], "project": [4, 6], "promot": 4, "prompt": [4, 8], "prompt_answ": 2, "prompt_answer_dataset": 2, "promptanswerdataset": 2, "promptanswerdatasetconfig": [2, 4, 5], "promptonlydatasetconfig": [2, 4, 5], "properli": 8, "properti": [2, 4], "proport": 4, "provid": [2, 4, 6, 8], "pt": 2, "pull": [1, 6], "purpl": 7, "py": 2, "py3": 6, "pypi": 5, "python": 8, "python3": [2, 3, 4, 8], "pytorch": [2, 6], "pyxi": 3, "qkv": 4, "queri": 4, "question": [1, 2], "quickstart": [2, 3, 4, 5, 6], "qwen": 4, "r": 6, "rais": [1, 2, 4], "random": 4, "randomli": 4, "rate": [4, 8], "rather": 4, "ratio": 4, "raw": 4, "re": [2, 8], "reach": 4, "read": 4, "real": [2, 3, 4, 6, 7, 8], "real_cuda": 6, "real_llm_api": [2, 4], "real_no_ext": 6, "realhf": [2, 3, 4, 6, 8], "realloc": [2, 4, 7], "realmodel": [2, 4, 5], "realmodelconfig": [2, 4, 5], "reason": 2, "recogn": 4, "record": [2, 4], "recov": 4, "recover_mod": 4, "recover_retri": 4, "recoveri": 4, "recurs": [4, 8], "redistribut": 4, "reduc": 8, "redund": 7, "ref": [4, 8], "ref_inf": [4, 8], "refer": [2, 3, 4, 8], "refinf": 8, "regard": 4, "regist": [2, 4], "register_dataset": 2, "register_hf_famili": 2, "register_interfac": 2, "register_metadata": [2, 4], "register_quickstart_exp": 2, "regular": [3, 4, 8], "rel": 8, "releas": 8, "remap": [2, 4, 8], "rememb": 6, "remind": 8, "remov": [2, 4], "repeatit": 4, "replac": 2, "repositori": [1, 2, 6, 8], "repres": [2, 8], "represent": 4, "request": [1, 2], "requir": [2, 4, 6, 8], "rerun": 6, "reserv": 2, "resid_pdrop": 4, "residu": 4, "resolv": 4, "resourc": 4, "respect": [2, 8], "respons": 8, "restrict": 4, "result": [2, 4], "resum": 4, "retri": 4, "return": [2, 4], "return_tensor": 2, "rew": [2, 4, 8], "rew_head_path": 4, "rew_inf": 4, "rew_lora_path": 4, "reward": [4, 5], "reward_output_bia": 4, "reward_output_sc": [4, 8], "rlhf": [1, 4, 5, 7], "rm": [4, 5], "rm_pair": 8, "role": 2, "rollout": 4, "rotari": 4, "rotary_bas": 4, "rotary_interleav": 4, "rotary_sc": 4, "rotary_scaling_typ": 4, "rpc": [2, 4], "rpchook": 4, "run": [2, 4, 6, 8], "runtim": [4, 6], "rw": 8, "rw_lora_path": 4, "rwconfig": [4, 5], "same": [4, 7, 8], "sampl": [2, 4, 8], "satisfi": 2, "save": [2, 4, 8], "save_dir": 2, "save_freq_step": [4, 8], "scale": [4, 7], "scale_attn_by_inverse_layer_idx": 4, "scale_attn_weight": 4, "scenario": 2, "schedul": 4, "score": 2, "score_model": 2, "score_token": 2, "script": 2, "search": [4, 8], "second": 7, "see": [2, 8], "seed": 4, "self": [2, 4], "sentiment": [2, 8], "sentiment_scor": 2, "sentimentscoringinterfac": 2, "separ": 3, "sequenc": [2, 4], "set": [4, 5, 6, 8], "sft": [2, 4, 8], "sft_interfac": 2, "sft_lora_path": 4, "sft_po": 8, "sftconfig": [2, 4, 5, 8], "sftinterfac": 2, "shape": 4, "shard": [2, 8], "share": 4, "should": [2, 3, 4, 6, 8], "show": [7, 8], "shown": [3, 7], "signal": [2, 4], "signatur": 2, "similar": [2, 4], "sinc": 4, "singl": [2, 4, 8], "six": [4, 8], "size": [4, 7, 8], "skip_special_token": 2, "slice": 4, "slurm": [3, 4], "smaller": 7, "so": [2, 4, 6, 8], "solut": 7, "some": [2, 4], "sourc": [1, 5, 7, 8], "space": 4, "specif": [2, 4, 8], "specifi": [2, 3, 4, 8], "srl": 4, "srun": 3, "stabil": 4, "stage": [4, 5], "start": 4, "state": [2, 4, 7], "step": [4, 5, 7, 8], "stop": [4, 8], "store": [2, 3, 4], "str": [2, 4], "strategi": [4, 7, 8], "string": [3, 4, 8], "structur": 8, "style": 2, "subclass": 4, "substanti": [7, 8], "successfulli": 8, "sum": 8, "super": [2, 4], "supervis": 5, "support": [3, 4, 5, 8], "sure": 4, "synchron": [4, 7], "syncparamhook": 4, "system": [2, 4, 7], "system_api": 2, "t": [2, 4, 6], "tailor": 7, "take": 8, "task": 7, "techniqu": [4, 8], "technologi": 1, "temperatur": 4, "templat": 1, "tensor": [4, 7, 8], "termin": 4, "test": 2, "text": [2, 4], "than": [4, 8], "thei": 4, "them": 4, "therefor": 8, "thi": [1, 2, 3, 4, 6, 8], "three": [2, 8], "throughput": 7, "tied_embed": 4, "time": [4, 7, 8], "timelin": 7, "tmp": 3, "to_llama": 2, "token": [2, 4], "tokenizer_path": 2, "top": 4, "top_k": [2, 8], "top_p": [2, 8], "torch": [2, 4], "total": [4, 8], "total_train_epoch": [4, 8], "train": [2, 4, 7, 8], "train_bs_n_seq": [4, 8], "train_path": [2, 4, 8], "train_step": 2, "trainactor": 4, "traincrit": 4, "transform": [2, 4], "transformerengin": 6, "travel": 8, "trial": 4, "trial_nam": [2, 4, 8], "trigger": 4, "true": [2, 4, 8], "truli": 1, "truncat": [2, 4], "tune": 5, "tutori": 8, "two": [2, 7, 8], "txt": 6, "type": [2, 3, 4, 8], "typic": 4, "u": [1, 6], "ubuntu": 6, "under": [2, 4, 7], "unfamiliar": 2, "unless": 4, "unpack": 4, "up": [4, 5, 7, 8], "updat": [2, 4, 8], "upload": 6, "upon": [4, 8], "us": [2, 3, 4, 6, 8], "use_adaptive_kl_ctl": 4, "use_attention_bia": 4, "use_attn_proj_bia": 4, "use_sequence_parallel": [4, 8], "user": [2, 4, 8], "usual": 4, "util": [2, 7, 8], "v": 4, "v1": 6, "valid": [4, 8], "valid_bs_n_seq": [4, 8], "valid_path": [4, 8], "valu": [4, 8], "value_eps_clip": [4, 8], "value_norm": [4, 8], "value_norm_beta": 4, "value_norm_ep": 4, "value_norm_typ": 4, "variabl": [2, 3, 6], "veri": 8, "version": [2, 6], "via": 8, "visit": 8, "vllm": 8, "vocab_s": 4, "vocabulari": 4, "wa": 4, "wai": [4, 6, 7], "wait": 4, "wait_for_offload": 4, "wandb": 4, "wandb_mod": 4, "want": [2, 6], "warm": 4, "warmup_steps_proport": 4, "we": [1, 2, 3, 4, 6, 7, 8], "weight": 4, "weight_decai": 4, "well": [2, 8], "what": [2, 4, 8], "wheel": 6, "when": [2, 3, 4, 7], "where": [2, 3, 4, 7, 8], "whether": [4, 6], "which": [2, 4, 8], "while": [7, 8], "wish": [1, 2], "within": 8, "without": [2, 4], "worker": [3, 4, 8], "workload": [7, 8], "wrap": 2, "write": 4, "x": 4, "y": 4, "yeah": 8, "you": [1, 2, 3, 4, 6, 8], "your": [2, 4, 6, 8], "zero": [4, 8], "zero_stag": 4}, "titles": ["Code Architecture", "Contributing", "Customization", "Set Up Distributed Experiments", "Configurations", "Welcome to ReaL\u2019s documentation!", "Installation", "Introduction", "Quickstart"], "titleterms": {"": 5, "1": 8, "2": 8, "3": 8, "30min": 8, "4x": 8, "7b": 8, "A": 2, "algorithm": 2, "architectur": 0, "code": 0, "configur": [2, 4], "content": 5, "contribut": 1, "custom": 2, "dataflow": 4, "dataset": [2, 4], "direct": 8, "distribut": 3, "docker": 6, "document": 5, "dpo": 8, "exampl": 2, "experi": [3, 4], "fine": 8, "from": 6, "function": 2, "graph": 4, "how": 2, "huggingfac": 2, "i": 2, "imag": 6, "implement": 2, "instal": [6, 8], "introduct": 7, "llama": 8, "model": [2, 4, 8], "namedarrai": 4, "new": 2, "optim": 8, "overview": 2, "pars": 2, "ppo": [2, 8], "prefer": 8, "pypi": 6, "quickstart": 8, "real": 5, "reward": [2, 8], "rlhf": 8, "rm": 8, "set": 3, "sourc": 6, "stage": 8, "step": 2, "supervis": 8, "support": 2, "tune": 8, "up": 3, "welcom": 5}})